# 1952060 张佰一 计算机网络实验报告 2021-2022学年秋季学期

[toc]

# 实验1 - 进程运行原理实验

## 实验目的

计算机网络交互主体是计算机进程，了解进程运行的基本原理，对于理解端与进程关系十分重要。本实验利用操作系统的进程管理软件来展示进程的生命周期。

- 了解进程的基本概念。
- 了解进程的基本运行原理，掌握基本进程管理技能。

## 实验原理

计算机程序是指用计算机语言开发的代码文件，一般需要编译成可执行代码。程序以文件方式存储在操作系统的文件系统中。进程指程序装载到内存中进行运行的代码段。现代操作系统可以对进程实施管理。

### 任务管理进程（Windows）
操作系统的任务管理器提供了用户计算机上正在运行的程序和进程的相关信息，也显示了最常用的度量进程性能的单位。使用任务管理器，可以打开监视计算机性能的关键指示器， 快速查看正在运行的程序的状态，或者终止已停止响应的程序。也可以使用多个参数评估干在运行的进程的活动， 以及CPU 和内存使用情况的图形和数据。任务管理器中，“应用程序”选项卡显示正在运行程序的状态，用户能够结束、切换或者启动桯序。”进程”选项卡显示正在运行的进程信息。

### 进程运行原理

1. 进程创建。程序一旦运行就成为进程，每个进程都分配一个唯一的进程编号，但其进程编号并不固定。
2. 进程运行。现代操作系统允许同时运行多个进程，每个进程运行时需要使用多种计算机部件资源，其中 CPU 资源必不可少，当 CPU 核数量小于并发进程数量时，操作系统会对CPU 实施共享，将CPU 运行时间划分成多个时间片，分配给各个进程提供运行，使所有进程都能同时运行，进程的并发运行并不是真正意义上的并发。
3. 进程终止。一般通过程序提供的退出按钮终止进程,也可以通过进程管理命令或软件结束进程

### 操作进程

1. Tasklist 命令：用于显示运行在本地或远程计符机上的所有任务的应用程序和服务列表，带有过程TO ; 可以监控川户操作。
2. Taskkill命令：用于结束一个或多个任务或进程。可以根据进程ID 或图像名来结束进程。（简写：Tskill）

备注：**这两个命令需要管理员身份的权限。**

### 网络进程

网络进程与一般进程具有基本相同的属性，唯一不同的特性是网络进程需要开启一到多个传输端口号（传输层：0-65535，其中0-1023 为保留端口号或系统端口）。一般来说，对于C/S 或B/S 架构的网络，客户端网络进程至少开启一个端口号，用于接收数据或发送数据。服务端网络进程则可能至少开启两个端口号，一个用于接收客户端的数据，一个用于发送数据给客户端。在Windows 系统中，可以使用相关命令查看正在使用的端口号。

## 实验环境

实验由一台安装 Windows 10 企业版操作系统的计算机担当，使用其任务管理器软件实施进程管理实验，也可以使用其他操作系统作为操作平台。

## 实验内容

实验将围绕进程的管理内容展开,使用任务管理器软件进行进程管理,通过鼠标进行操作，从屏幕观看操作结果。

1. 多次运行同一个特定应用程序，看到该程序可以以多个不同的进程同时运行，每次运行，进程号会不一样。
2. 通过应用程序界面关闭程序，看到其进程被结束
3. 通过任务管理器关闭进程,终止应用程序的运行。

## 实验步骤

1. 打开任务管理器（`ctrl`+`alt`+`delete`）
2. 观察任务管理器窗口，可见名称、PID、状态、用户名、CPU、内存、描述的字段，用以描述一个进程。
3. 打开命令提示符（`cmd`），打开浏览器。
4. 查看刚刚打开的程序进程信息。可见`cmd`创建了一个进程，Chrome则创建了许多进程。
5. `> Taskkill 20900`命令，将该进程结束

## 实验小结

通过OS的学习，易知计算机处理任务其实是在进程和线程上工作，为了便于管理员用户管理，操作系统给用户提供了查看正在运行的程序和进程的相关信息。我们实验就通过这个入口查看所需信息。

## 实验图片

![](./assets/1-1.png)



# 实验2 - 网络端地址实验

## 实验目的

网络端地址用于标识计算机网络进程，网络进程是计算机网络传输主体，由于语言表达上问题，容易误将计算机作为计算机网络的传输主体。明确了网络传输主体，就容易理解计算机网络各项具体功能处理的基本原理。本实验利用浏览器上网这个最为熟悉的应用，呈现网络端地址作用。

1. 明确计算机网络交互的主体是进程。计算机网络两台计算机之间的交互，实质上是两个进程之间的交互。
2. 了解网络端地址构成及使用。端地址是用于标识网络上任意一台计算机上的任意个网络进程，具有唯一性和不变性，只有通过访问网络端地址才能通过网络同该进程交互。但在日常使用应用协议时，常常忽略端口地址，自动采用该应用协议缺省端口地址作为网络端地址。

## 实验原理

计算机网络正如其名字所揭示的一样，就是用于计算机之间的交互，但只是宽泛的表述，现代计算机中真正执行主体实际上是各个进程。所谓两台计算机交互，按照计算机网络通信交互模型，必然是某两个进程之间的交互。网络进程的识别是通过网络端地址来实施。端地
址格式如下：
`IP:PORT`
用于标识互联网任意一个节点上的任意一个网络进程，IP指主机 IP 地址，也可以使用域名，域名会被域名系统自动转换成 IP 地址；PORT 指该进程的网络端口号，进程运行时会被注册并建立与进程号的映射关系，通过端口号，可以访问到对应进程，进行网络交互。

### 网络端口地址的划分

| 端口范围   | 作用                                                         |
| ---------- | ------------------------------------------------------------ |
| 0~1023     | 【系统端口】这些端口只有系统特许的进程才能使用。             |
| 1024~5000  | 【用户端口】临时端口，一般的应用程序使用1024到4999来进行通讯。 |
| 5001~65535 | 【用户端口】服务器端口，用来给用户自定义端口。               |

### 常见的端口号（TCP/UDP）

| 服务名称 | 端口号                                                       |
| -------- | ------------------------------------------------------------ |
| FTP      | FTP使用的端口号是20和21。20端口用于数据传输，21端口用于控制信息的传输，控制信息和数据能够同时传输，这是FTP的特殊之处 |
| TFTP     | 端口号69，使用UDP的连接TFTP（Trivial File Transfer Protocol,简单文件传输协议）是TCP/IP协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。 |
| UDP      | 端口53：DNS 域名解析服务；                                   |
| TCP      | 端口80：HTTP 超文本传输服务；                                |
| TCP      | 端口443：HTTPS 加密的超文本传输。                            |
| DHCP     | 服务器端的端口号是67                                         |
| DHCP     | 客户机端的端口号是68                                         |
| POP3     | POP3接收协议，POP3客户端使用SMTP向服务器发送邮件。POP3使用的端口号是110。 |
| SMTP     | 端口号是25，SMTP真正关心的不是邮件如何被传送，而只关心邮件是否能顺利到达目的地。 |
| Telnet   | 端口号23：测试端口号，可以使用telnet命令来测试端口号是否正常打开还是关闭。 |

## 实验环境

由一台计算机担当实验设备，计算机必须连接互联网。使用Chrome浏览器。

## 实验内容

任何开放的互联网 Web 网站按照业界习惯，都使用`80`端口地址作为 HTTP 协议的端地址。浏览器地址栏支持端地址使用，当没有输人端地址时，就会自动采用应用协议的缺省端地址，HTTP 协议的缺省端地址是`80`。实验使用 Chrome浏览器访问互联网上任意一个网站，通过设置网络端地址,来验证其作用。主要实验内容：

1. 端地址设置成`81`端口时，浏览器无法浏览网页。
2. 端地址设置成`80`端口时，浏览器可以正常浏览网页。

## 实验步骤

*由于学校门户网站已经升级为`HTTPS`协议，所以本实验在`HTTPS`版本中的门户网站环境下进行。*

访问`https://www.tongji.edu.cn:81`：

```
无法访问此网站
www.tongji.edu.cn 拒绝了我们的连接请求。
请试试以下办法：

检查网络连接
检查代理服务器和防火墙
ERR_CONNECTION_REFUSED
```

访问`https://www.tongji.edu.cn:80`：

```
此网站无法提供安全连接
www.tongji.edu.cn 发送的响应无效。
尝试运行 Windows 网络诊断。
ERR_SSL_PROTOCOL_ERROR
```

*这是因为`HTTPS`默认的端口号是`443`而不是`80`。*

访问`http://www.tongji.edu.cn:80`：

可以访问，但跳转到了`HTTPS`协议的网站。

访问`https://www.tongji.edu.cn:443`：

可以访问。

## 实验小结

本次实验，主要是要学习到计算机网络的思考方式：进程和进程之间交互、端口和进程的联系。

计算机上网是怎么上的？这个问题我目前的理解是：计算机连接到互联网会被分配一个公网IP，这个IP相当于计算机的身份证。但是根据网络连接实际上是网络进程之间的连接这一知识，只用一个身份证是不够的，还需要一个端口号来区分不同的进程。当我们访问一个网页，就是用我们的`IP:PORT`这个进程唯一的标识符去访问服务器的`IP:443`的进程，两个进程如此完成交互。

## 实验图片

![](./assets/1-4.png)



# 实验3 - 网络线的制作和测试实验项目

## 实验目的

- 了解局域网组网原理
- 理解掌握以太网组网步骤
- 了解双绞线网线的制作过程

## 实验原理

有三种形式的导线的能帮助减小电气噪声的干扰，其中除了同轴电缆就是双绞线。双绞线有两根绞在一起的导线构成。每一根导线都有一层起绝缘作用的塑料包裹，防止导线之间短路。屏蔽双绞线（STP）使用更细更柔韧的金属屏蔽层包裹一对或多对双绞线，其优点是柔韧性比同轴电缆要好，同时其抗电磁噪声干扰的能力要比非屏蔽双绞线强。

本实验中使用的**五类双绞线**是用于网络的无屏蔽双绞线，数据速率在`100Mbps`左右。

## 实验材料

两个**TJ45水晶头**，一段五类双绞线。

## 实验内容

使用工具和材料制作双绞线直通线，并用测试设备测试。

## 实验步骤

1. 用压线钳将网线一段的套管皮剪掉`2cm`
2. 按照**白橙、橙、白绿、蓝、白蓝、绿、白棕、棕**的线序将网线排列好
3. 把网线摆平拉直，剪齐留下`1.5cm`
4. 水晶头弹簧片一面向下，将线插入其中，使线紧紧地顶在顶端
5. 将水晶头插入压线钳套住水晶头用力压，使网线和水晶头卡在一起
6. 使用以太网测试工具，将网线线两端头插入网线测试仪。可以观察到**表示八个通路的指示灯依次闪烁**，测试通过，说明制作成功。

## 实验小结

本次实验动手为主。一直以来我对于双绞线的认识都是即插即用，此次实验带给我一个从横截面观察双绞线内部构造的机会。双绞线按照严格的角度和力度绞在一起，末端和水晶头连接的时候牵扯到不同颜色的顺序和压紧的工艺，所以人工可能比机器要靠谱。但是我的第一次尝试却失败了，原因是剪齐线的环节没有把握好，某根线的长短和其他线不一样，导致这根线的指示灯没有亮。一方面感叹测试器相当好用，可以迅速知晓错误原因；另一方面感叹这个工作确实需要相当的耐心。

最后用自制的网线完成了另一个组网的实验，非常有成就感。

## 实验图片

![3-1](.\assets\3-1.jpg)

![3-2](.\assets\3-2.jpg)

![3-3](.\assets\3-3.jpg)



# 实验4 - IOS基本操作实验

## 实验目的

- 了解IOS基本知识
- 理解实验网络物理组网原理
- 登录路由器
- 熟悉IOS中的各种命令的用途
- 熟悉IOS命令的使用方法

## 实验原理

### IOS操作系统简介

IOS(Internetwork Operating System)，全称是网际操作系统，由思科公司(CISCO) 首先提出和使用，主要运行在思科网络设备上,包括路由器、交换机和防火墙等，本书（《计算机网络实验教程》）实验中网络设备均使用了IOS操作系统。IOS和主机上操作系统一样，是网络设备管理操作的灵魂，所有配置是通过 IOS完成的。因为使用方便高效,随后网络设备的操作系统基本采用了该种操作模式,通用性很强。IOS采用命令行界面(Command Line Interface, CLD。因为网络设备没有专门的屏幕和键盘，必须借助于虛拟终端实施操作，一般有两种途径：一是使用超级终端。通过串口线连接路由器的 CONSOLE 口，进行本地访问；二是Telnet远程终端，可以通过网络访问,但首次必须使用超级终端配置好网络地址,才能进行远程访问。IOS 操作系统分设置模式和操作模式两种运行模式。

### 接线原理

![](.\assets\4-1.PNG)

将计算机与交换机连接（计算机：RS232；交换机：RJ45）；

再将交换机与路由器相连（双绞线）

### 路由器的操作模式

1. 用户模式
网络设备启动后，如果已经进行了初始化设置，就自动进人用户模式，用户模式操作提示符采用符号“>”。以路由器为例，如router>，提示符前是路由器名(hostname），路由器名可以通过 hostname命令设置，具体名宇不作规定。用户模式下，操作以查询为主，一般不能对参数进行修改和设定，也查询不到主要参数。使用**enable 命令**，可以从用户模式切换到特权模式。退出用户模式，使用**logout 命令**，
2. 特权模式
    特权模式允许对配置进行修改和重要参数查看，特权模式使用受到口令保护，只有通过口令验证才能从用户模式切换到特权模式，特权模式操作提示符采用**符号“#”**。使用 **disable 命令**，可以从特权模式返回到用户模式；参数修改，则需要使用 **configure terminal 命令**，切换到配置模式。
3. 配置模式
    有时也称全局配置模式，全局配置模式操作提示符采用字符串提示符(config)。使用**exit命令**，可以从配置模式退回到特权模式；对于物理网络端口配置，还必须使用 interface 命令，切换到端口配置模式。
4. 端口配置模式
    端口配置模式主要对物理网络端口进行配置，常见对以太网端口和串行端口进行配置，端口配置模式采用**字符串提示符(config-if)**，端口配置完成后，使用 exit 命令，退回到配置模式，注意一定要退回到特权模式，配置参数才能生效。

| Command Mode                    | Access Method | Password      | Prompt Displayed | Exit Method |
| ------------------------------- | ------------- | ------------- | ---------------- | ----------- |
| User Exec用户                   | Log in        | Virtual       | >                | Logout      |
| Privileges Exec特权             | enable        | Enable Secret | #                | disable     |
| Global Configuration配置        | Config t      |               | (config)#        | Exit/ctrl+z |
| Interface Configuration端口配置 | Inter         |               | (config-if)#     | Exit/ctrl+z |

## 实验材料

1. 计算机，运行Windows操作系统
2. 超级终端 HyperTerminal
3. RS232转RJ45连接线、网线

## 实验内容

接线，测试不同的IOS操作模式，了解不同命令的区别和用法。

## 实验步骤

建立HyperTerminal：超级终端：名称=router；连接=com1；Baud Rate=9600；8，no parity，1 stop bit；呼叫

测试以下命令：

1. **?**
   操作帮助：代替符合命令格式的任何余项
   --寻求帮助：router01> ?
   --寻求帮助：router01> sh ?
2.  **show**
   --寻求帮助：router01> sh ?
   --查看系统配置：router01> sh version
   --查看（静态）路由表：router01>sh ip route
   --寻求帮助：router01> sh ?
   --寻求帮助：router01> sh in ?
   --寻求帮助：router01> sh int g ?
   --查看以太网口配置：router01> sh int gt 0/0
   --寻求帮助：router01> sh int ser ?
   --查看串口配置：router01> sh int serial 0/0
   --查看路由表配置信息：router01> sh running-config  #权限不够
3. **enable**
   --进入特权模式：router01>en(able) ，Enable Secret Password=**cisco**
   --查看路由表配置信息：router01# sh running-config 
   --寻求帮助：router01# sh int g ?
   --查看以太网口配置：router01# sh in g 0/0
   --寻求帮助：router01# sh int ser ?
   --查看串口配置：router01# sh int serial 0/0
4. **config**
   --进入配置模式：router01#config t
   --寻求帮助：router01(config)# ?
5. **interface**
   --寻求帮助：router01# inter fast ?
   --进入以太口：router01(config)#int g 0/0
   --修改IP地址： router01(config-if)#ip address 192.168.x.2
6. **end**
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int g 0/0
7. **ping** 
   --连通测试命令: router01# ping 192.168.x.254
8. **shut**
      关闭端口
   --进入配置模式：router01#config t
   --进入以太口：router01(config)#int g 0/0
   --关闭端口功能：router01(config-if)#no shut
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int g 0/0
9. **no**
   反命令
   --进入配置模式：router01#config t
   --进入以太口：router01(config)#int g 0/0
   --打开端口功能：router01(config-if)#no shut
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int gt 0/0
   --进入以太口：router01(config)#int g 0/0
   --删除IP地址： router01(config-if)#no ip address <ipaddress><subnet mask>

## 实验小结

本次实验初识路由器、交换机这一类耳熟能详但队其运作原理又非常陌生的设备。

对于路由器和交换机，我在网上了解到相关的资料如下：

路由器就是连接两个以上个别网络的设备。

由于位于两个或更多个网络的交汇处，从而可在它们之间传递分组（一种数据的组织形式）。路由器与交换机在概念上有一定重叠但也有不同：交换机泛指工作于任何网络层次的数据中继设备（尽管多指网桥），而路由器则更专注于网络层。

路由器与交换机的差别，路由器是属于OSI第三层的产品，交换机是OSI第二层的产品。第二层的产品功能在于，将网络上各个电脑的MAC地址记在MAC地址表中，当局域网中的电脑要经过交換机去交换传递资料时，就查询交换机上的MAC地址表中的信息，将数据包发送给指定的电脑，而不会像第一层的产品（如集线器）每台在网络中的电脑都发送。而路由器除了有交换机的功能外，更拥有路由表作为发送数据包时的依据，在有多种选择的路径中选择最佳的路径。此外，并可以连接两个以上不同网段的网络，而交换机只能连接两个。

了解IOS的操作，对于之后的实验应该也是一个基础。



# 实验5 - Socket编程实验

## 子实验1 - UDP协议网络编程实验

#### 实验目的

- 理解客户机/服务器模型，了解端口在网络传输中的作用
- 了解无连接通信方式以及编程方式
- 了解掌握基于Socket的UDP应用编程的基本步骤
- 了解并发服务原理及编程方式

#### 实验原理

##### Socket 概况

Socket套接字是基于TCP/IP传输层的网络编程标准。套接字已实现了TCP/IP协议的各种基础功能，并提供了高层的编程接口。使用者只用调用高层接口，就能实现相应功能。

##### UDP编程原理

UDP 是**User Datagram Protocol**的简称， 中文名是用户数据报协议，是OSI（**Open System Interconnection**，开放式系统互联） 参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务。

- `DatagramPacket`类，代表UDP数据对象。
- `DatagramSocket`类，代表UDP协议对象，对象包含了代表UDP端口的属性，两个主要方法：`send(DatagramPacket)`和`receiver(DatagramPacket)`。采用无连接的传输服务，直接通对方进行数据发送和接收。

#### 实验代码

`UDPServer.java`

```java
		DatagramSocket server=new DatagramSocket(5555); //创建Socket
		request=new DatagramPacket(buffer, buffer.length); //创建Socket数据包缓冲区
//...
		while(true){
            //receive message
			server.receive(request);
			String req=new String(request.getData()).trim();
            System.out.println("Request:"+req);
			//send message
			server.send(request);
		}
```

`UDPClient.java`

```java
	String serverIP = "";
		try {
            //获取UDP服务器地址对象
			serverIP = this.textFieldIP.getText();
			server = InetAddress.getByName(serverIP);
            
			System.out.println("Server:" + server.getHostAddress());
			
			byte[] bufferReceived = new byte[101];
			response = new DatagramPacket(bufferReceived, bufferReceived.length);
			this.btnSend.setEnabled(true);

		}

//...

	client = new DatagramSocket(); //创建Socket，但无需指定端口号。

//...

	//创建UDP数据包缓冲区request，存放应用数据，需要制定服务器地址和端口号。
	bufferSended = this.textMessage.getText().getBytes();
	client = new DatagramSocket();// client
	request = new DatagramPacket(bufferSended, bufferSended.length, server, 5555);
	// send
	client.send(request);   
	this.textMessage.setText("");
	// receive
	client.receive(response);
	this.textChat.setText(this.textChat.getText() + "\r\n" + new String(response.getData()).trim());	

```

#### 实验内容

在Eclipse中开发上述`UDPServer`和`UDPClient`两个类。

先运行服务器，后运行客户机，进行即时通信。

#### 实验结果

![](.\assets\5-1.png)

## 子实验2 - TCP协议与并发编程

#### 实验目的

- 理解客户机/服务器模型，了解端口在网络传输中的作用
- 了解无连接通信方式以及编程方式
- 了解基于TCP网络应用服务器的基本编程架构
- 了解面向连接和无连接的区别，了解TCP编程基本步骤
- 了解并发服务原理及编程方式

#### 实验原理

传输控制协议（TCP，**Transmission Control Protocol**）是一种面向连接的、可靠的、基于字节流的传输层通信协议。

##### 并发服务

UDP 采用无连接服务，可同时接待多个客户访问。TCP 采用面向连接方式，服务器一旦同一个客户机建立了会话，就无法同其他客户再建立会话，严重影响用户体验。并发服务能力是指服务器具有同时建立多个会话，允许多个客户访问的能力，日常使用的TCP 服务器均是并发服务器。但并发服务不属于网络技术而属于编程技术研究范畴，并发服务器程序有着特殊的编程架构，典型架构由两部分代码组成，第一部分是主进程，负责请求调度，按受客户请求申请,建立会话并为每个请求创建服务处理线程；第二部分是服务处理线程，负责具体会话处理，为客户请求提供服务，可以被主进程不断创建。

假定有两个客户访问同一个TCP 服务器。TCP 服务器启动后，只有主进程在运行，开启服务端口 PORT,等待客户端访问。第一个客户访问 PORT端口，主进程接收到请求 1，**创建一个服务线程** 1负责处理请求 1，随后的会话发生在客户机 1和服务线程 1之间，主进程等待下一次请求到来；第二个客户访问 PORT 端口，主进程接收到请求 2，再创建另一个服务线程 2负责处理请求，随后的会话发生在客户机 2和服务线程 2之间，主进程继续等待下一个请求。如果同时有 N个客户访问服务器，这时候，就有N+1个线程（进程）在运行；主进程永远
等待客户访问。并发处理的数量理论上没限制，主要取决于计算机处理能力，涉及 CPU 核数量和内存大小。

##### TCP实验程序编程

综上所述，除了需要客户机和服务器之外，还需要让服务器具备并发能力。所以需要创建三个类：客户机、服务器的主进程和服务器的服务线程。基本功能同UDP编程实验类似。

#### 实验代码

`MainServer.java`

```java
ServerSocket server = new ServerSocket(5588); //创建TCP服务Socket，Java提供ServerSocket专门作为TCP服务Socket

//...等待来自客户机的请求

	while (true) {
        //一旦成功就会创建Socket会话对象
		Socket client = server.accept();
        //接着创建ServiceServer服务进程，将Socket会话对象传递过去。
		ServiceServer service = new ServiceServer(client);
        //启动线程运行，负责同客户机的数据传输及处理。
		Thread thread=new Thread(service);
		thread.start();
		threadList.add(service);			
	}

```

`ServiceServer.java`作为服务线程负责实际数据处理和服务。

```java
//从会话对象Socket获得数据流，发送是输出流，接收为输入流。
public ServiceServer(Socket c)throws IOException{
		this.client=c;
		is=new ObjectInputStream(client.getInputStream());
		os=new ObjectOutputStream(client.getOutputStream());
	}
//利用输入输出流同客户端进行数据交互
Object obj=is.readObject();

BufferedReader in = new BufferedReader(new InputStreamReader(client.getInputStream()));
out = new PrintWriter(client.getOutputStream());//PrintWriter打印接收到的客户端数据

//交互结束，关闭会话对象
in.close();
out.close();
client.close();
```

`TcpClient.java`

```java
//请求同TCP服务器建立会话，指定服务器的地址和端口。
serviceSocket = new Socket(this.txtFieldIP.getText(), 5588);
//从会话对象Socket获得数据流。接收到消息就PrintWriter，反之写输入流。
out = new PrintWriter(serviceSocket.getOutputStream());
in = new BufferedReader(new InputStreamReader(serviceSocket.getInputStream()));
//交互结束，关闭会话对象。
serviceSocket.close();
```

#### 实验内容

开发服务器程序，创建实现`MainServer`类和`ServiceServer`类，再开发客户机程序`TcpClient`类，最后测试交互。可以在`main()`中双剑两个测试客户访问。

#### 实验结果

运行`MainServer`：

![](.\assets\5-2.png)

运行客户机并测试

![](.\assets\5-3.jpg)

## 实验小结 - Socket网络实验

TCP是面向连接的协议，在收发数据前必须和对方建立可靠的连接，建立连接的3次握手、断开连接的4次挥手，为数据传输打下可靠基础;UDP是一个面向无连接的协议，数据传输前，源端和终端不建立连接，发送端尽可能快的将数据扔到网络上，接收端从消息队列中读取消息段。

从上面TCP、UDP编程步骤可以看出，UDP 服务器端不需要调用监听(listen)和接收(accept)客户端连接，而客户端也不需要连接服务器端(connect)。UDP协议中，任何一方建立Socket后，都可以发送数据、接收数据，不必关心对方是否存在，是否发送了数据。

为了实现TCP网络通信的可靠性，增加校验和、序号标识、滑动窗口、确认应答、拥塞控制等复杂的机制，建立了繁琐的握手过程，增加了TCP对系统资源的消耗；TCP的重传机制、顺序控制机制等对数据传输有一定延时影响，降低了传输效率。TCP适合对传输效率要求低，但准确率要求高的应用场景，比如万维网(HTTP)、文件传输(FTP)、电子邮件(SMTP)等。

UDP是无连接的，不可靠传输，尽最大努力交付数据，协议简单、资源要求少、传输速度快、实时性高的特点，适用于对传输效率要求高，但准确率要求低的应用场景，比如域名转换(DNS)、远程文件服务器(NFS)等。

本次实验可以很好地展示两种协议的建立方法的不同，为今后的网络编程学习打下基础。



# 实验6 - 异步串行（物理层）通信实验

## 实验目的

- 理解异步串行通信基本原理
- 熟悉掌握RS-232通信标准以及RS-232帧格式
- 了解波特率等主要通信参数的作用和使用

## 实验原理

### 串行传输模式

串行传输模式是指任何通信用户单独只能占用一条通信信道，对二进制数据按照顺序依次发送，每次只能传输一个数位，0或1。串行传输模式被广泛应用在远程通信中。串行传输模式在实际运用中，又分为同步串行传输模式和异步串行传输模式。同步串行传输模式要求通信的收发双方在时间基准上保持一致。异步串行传输模式，接发两端使用不固定的时间模式，传输前也不需要协调，只要直接发送，不需要对方作为应答,但必须在传输两个数据包之间加人间隔符号作为分隔。常用的串行通信接口标准包括 RS-232，RS-449，V.24，V.35 等。其中，RS-232 是最常用的串行通信接口标准。

图为串行传输模式结构示意图。注意到并不是每一位都用来传输数据，还需要起始位、检验位相配合才能保证数据完整、准确运达。

![](.\assets\6-1.jpg)

### RS-232接口
RS-232 接口是 1970年由美国电子工业协会（EIA）联合贝尔实验室、调制解调器厂家及计算机终端生产厂家共同制定的用于异步串行传输模式的标准。主要内容就是定义数据终端设备 DTE 和数据通信设备 DCE之间的接口标准。RS-232 传输对象是宇符，每次传输一个宇
符，可持续传输多个字符。RS-232 异步串行传输模式，其物理信号采用电压作为传输信号，电压处于士15V之间，其信号状态标准：空闲状态信号，用负电压来表示；数位 0，用正电压来表示；数位1，用负电压表示。

### 波特率

波特率也称调制速率，指单位时间内通信信号变化的次数。波特率决定着每个数位的传输速率，显然，涉及接发两端的两个设备配置，为保证两者在发送信号和检测信号时的时间同步，就必须设置成相同的波特率。发送设备和接收设备采用相同波特率称为波特率匹配。如
果接发双方波特率不匹配，就会发生传输错误，称为帧错误。

### 循环冗余校验

循环冗余校验（英语：Cyclic redundancy check，通称“CRC”）是一种根据网络数据数据包或电脑文件等数据产生简短固定位数校验码的一种散列函數，主要用来检测或校验数据传输或者保存后可能出现的错误。生成的数字在传输或者存储之前计算出来并且附加到数据后面，然后接收方进行检验确定数据是否发生变化。

一般来说，循环冗余校验的值都是32位的整数。由于本函数易于用二进制的电脑硬件使用、容易进行数学分析并且尤其善于检测传输通道干扰引起的错误，因此获得广泛应用。此方是由W. Wesley Peterson于1961年发表。

CRC为校验和的一种，是两个字节数据流采用二进制除法（没有借位和进位，使用异或来代替减法）相除所得到的余数。其中被除数是需要计算校验和的信息数据流的二进制表示；除数是一个长度为(n+1)的预定义二进制数，通常用多项式的系数来表示。在做除法之前，要在信息数据之后先加上n个0. 冗余码的位数是n位。

冗余码的计算方法是，先将信息码后面补0，补0的个数是生成多项式最高次幂；将补零之后的信息码用模二除法（非二进制除法）除以G(X)对应的2进制码，注意除法过程中所用的减法是模2减法，即没有借位的减法，也就是异或运算。当被除数逐位除完时，得到比除数少一位的余数。此余数即为冗余位,将其添加在信息位后便构成CRC码字。

例如，假设信息码字为`11100011`，生成多项式`G(X)=X^5+X^4+X+1`，计算CRC码字。`G(X) = X^5+X^4+X+1`，也就是`110011`，因为最高次是5，所以，在信息码字后补5个0，变为`1110001100000`。用`1110001100000`模二除法除以`110011`，余数为`11010`，即为所求的冗余位。

因此发送出去的CRC码字为原始码字`11100011`末尾加上冗余位`11010`，即 `1110001111010`。接收端收到码字后，采用同样的方法验证，即将收到的码字用模二除法除以`110011`（是G(X)对应的二进制生成码），发现余数是0，则认为码字在传输过程中没有出错。

尽管在错误检测中非常有用，CRC并不能可靠地校验数据完整性（即数据没有发生任何变化），这是因为CRC多项式是线性结构，可以非常容易地故意改变量据而维持CRC不变。

### 奇偶校验位

奇偶校验位（英语：parity bit）或校验比特（英语：check bit）是一个表示给定位数的二进制数中1的个数是奇数还是偶数的二进制数。奇偶校验位是最简单的错误检测码。

奇偶校验位有两种类型：偶校验位与奇校验位。

以偶校验位来说，如果一组给定数据位中`1`的个数是奇数，补一个bit为`1`，使得总的1的个数是偶数。例：`0000001`, 补一个bit为`1`, `00000011`；以奇校验位来说，如果给定一组数据位中`1`的个数是奇数，补一个bit为`0`，使得总的`1`的个数是奇数。例：`0000001`， 补一个bit为`0`，即 `00000010`。

偶校验实际上是循环冗余校验的一个特例，通过多项式 `x + 1` 得到1位CRC。

### 并行传输与串行传输模式之区别

并行传输：字符编码的各位（比特）同时传输，也就是使用多根并行的数据线一次同时传输多个比特。

串行传输：将组成字符的各位串行依次地传输，使用一根数据线传输数据，一次传输1个比特，多个比特需要一个接一个依次传输；在串行传输中又分为同步传输和异步传输。

## 实验环境

实验环境由两台带串口的计算机组成，一根串行交叉线用于连接两个计算机的串口。使用“友善串口调试助手”作为串口调试软件。

## 实验内容

进行两台计算机之间的异步串行通信，一端从键盘输入字符发送，另一端观看接收到的内容。

1. 异步串行通信实验。相同通信参数下的通信，进行相互间的字符接发送。
2. 波特率通信实验。不同波特率条件下的通信，其他参数保持相同，进行相互间的字符接发送。
3. 不同校验方式通信实验。一方使用奇校验，一方不使用校验。
4. 相同校验方式实验。双方使用偶校验的通信情况。

## 实验步骤

首先，将两台计算机的COM口用串口反接连接线连接起来。

【实验一：异步串行通信实验】

1. 建立异步串行连接
2. 两台主机向对方发送消息。

观察到可以接收到完整的消息，且即时发送。

【实验二：波特率通信实验】

1. 重新设置通信参数，将波特率、校验位、数据位、停止位更改成不相同，再次实验。

观察到接收到的信息存在乱码，且乱码的出现**没有规律**，**不可逆**。

【实验三：不同校验方式通信实验】

1. 设置主机一方为偶校验，另一方为无校验。其他参数不变。

观察到对于采用了无校验位的一方，可以接收到另一方发来的有校验位的数据，但发送的数据并没有被另一方正确接收，显示为乱码。

这是因为接收端采用无校验位，不影响接受有校验位的数据；采用偶校验位，将对接收到的数据进行校验。

【实验四：相同校验方式通信实验】

1. 设置两台主机的校验方式相同，再进行上述实验。

观察到可以接收到完整且正确的数据。

## 实验小结

在物理层，数据的传输需要考虑的问题是：准确性、完整性和高效率。首先，采取相同的波特率可以让串口在同一频率上通信；其次，采取相同的奇偶校验位可以使传输的准确性大大增强。在串行通信中，常用的格式是7个数据位、1个校验位、1到2个停止位。这种格式用方便的8位字节巧妙地适应了所有的7位ASCII字符。也可以用其它的格式表示，8位数据加上1个校验位可以传输任意的8位字节数据。

## 实验图片

正常通信：

![](./assets/6-6.png)

无校验位，可以正常接收到信息：

![](./assets/6-4.png)

更改停止位为2，接收到数据被从中间分隔开来：

![](./assets/6-5.PNG)

更改波特率出现乱码：

![](./assets/6-3.PNG)



# 实验7 - 物理地址解析实验

## 实验目的

IP网络不具有实际通信能力，需要将IP数据包封装在物理帧中进行运输，封装前需要对下一跳IP地址进行物理地址解析。物理地址解析是理解IP封装的关键知识点，但物理地址解析行为非常隐蔽，难以察觉。实验利用 ARP 协议的缓存机制来间接证明物理地址解析行为的发生：

1. 理解 IP网络和物理网络之间的功能关系。
2. 了解 ARP 地址解析原理。
3. 掌握 ARP 工具软件使用。

## 实验原理

### ARP

ARP 协议的全称是 `Address Resolution Protocol(地址解析协议)`，它是一个通过**用于实现从 IP 地址到 MAC 地址的映射，即询问目标 IP 对应的 MAC 地址** 的一种协议。ARP 协议在 IPv4 中极其重要。简而言之，ARP 就是一种解决地址问题的协议，它以 IP 地址为线索，定位下一个应该接收数据分包的主机 MAC 地址。如果目标主机不在同一个链路上，那么会查找下一跳路由器的 MAC 地址。

### ARP 地址解析协议

物理地址解析指由 IP 地址获取物理地址的过程。IP网络是虛拟网络，需要将IP数据包封装在物理帧中进行传输，在构造物理帧的过程中，需要使用物理地址作为源节点和目的节点的标识。

ARP 协议是IP协议的辅助协议，负责完成IP 地址解析。在IP协议传输前，将调用 ARP 协议获取下一跳节点物理地址。ARP 数据包称为 ARP 消息，ARP 是底层协议，ARP 消息本身也是直接封装在物理帧中进行传输的。

![](./assets/7-1.jpg)

ARP 协议采用消息交互方式来实施。假如第二台主机需要解析第三台主机的网卡物理地址，知道其IP地址为`IP3`。协议实施分两次通信：

1. 第二台主机对地址解析请求消息进行**广播**。构建 ARP 解析请求消息，`ARP REQ:IP3` 表示请求解析 IP3 主机物理地址的 ARP 请求消息，请求消息被直接封装到物理帧中，并设置目标物理地址为以太网广播地址 `FF: FF:FF:FF:FF:FF`，然后发送该物理帧。

2. 网络广播域内的所有主机，即第一、三和四主机，均将接收到该广播的 ARP 请求消息，并检查其解析请求消息中存放的目标IP地址；最终处理结果：其他主机因 IP 地址不是`IP3 `则丢弃 ARP 请求消息，只有第三台主机的IP 地址才是` IP3`，负责解析其物理地址，构建 ARP 响应消息，`ARP RESP: IP3/MAC3` 表示 ARP 响应消息中填写了自身的物理地址 `MAC3`，并依据请求中源物理地址` MAC2 `直接给该地址返回 ARP 响应消息；第二台主机接收 ARP 响应消息，从 ARP 响应消息中取出` MAC3`，就得到了解析的物理地址。

### MAC地址

MAC 地址的全称是 `Media Access Control Address`，译为媒体访问控制地址，它是网络上以太网或网络适配器的唯一标识符。MAC 地址能够区分不同的网络接口，并用于多种网络技术，尤其是大多数 IEEE 802 网络。MAC 地址也称为物理地址，硬件地址和老化地址。

MAC 地址主要用于识别数据链路中互联的节点，MAC 地址长 48 bit，在使用`网卡(NIC)` 的情况下，MAC 地址一般都会烧入 ROM 中。因此，任何一个网卡的 MAC 地址都是唯一的。

MAC 地址中的 3 - 24 位表示厂商识别码，每个 NIC 厂商都有特定唯一的识别数字。25 - 48 位是厂商内部为识别每个网卡而用。因此，可以保证全世界不会有相同 MAC 地址的网卡。

MAC 地址也有例外情况，即 MAC 地址也会有重复的时候，但是问题不大，**只要两个 MAC 地址是属于不同的数据链路层**就不会出现问题。

### ARP缓存

ARP 高效运行的关键就是维护每个主机和路由器上的 `ARP 缓存(或表)`。这个缓存维护着每个 IP 到 MAC 地址的映射关系。通过把第一次 ARP 获取到的 MAC 地址作为 IP 对 MAC 的映射关系到一个 ARP 缓存表中，下一次再向这个地址发送数据报时就不再需要重新发送 ARP 请求了，而是直接使用这个缓存表中的 MAC 地址进行数据报的发送。每发送一次 ARP 请求，缓存表中对应的映射关系都会被清除。

通过 ARP 缓存，降低了网络流量的使用，在一定程度上防止了 ARP 的大量广播。

两台主机往往需要连续传输多个IP数据包，为避免重复进行地址解析，ARP 协议软件引进了缓存机制，一旦收到响应消息，解析地址取出使用后还要缓存起来。每当 ARP 需要解析时，首先查询 ARP 缓存表；一旦在缓存中找到解析地址,就不再发送解析请求，而是直接使用
缓存中保存的解析地址，只有在找不到解析地址时，才利用网络进行地址解析。缓存表填满时，则将最长久未被使用的解析项替代出来。

另外，还设定了缓存超时长度，超时未被使用的项，都将会被自动删除，以消除长时间缓存带来的副作用，ARP 协议实施的物理网络需要具有广播传输方式，不是所有物理网络都可以实施 ARP 协议，目前主要应用于以太网。

## 实验环境

两台计算机和一台交换机担当实验设备。使用两根以太网络线，将两台计算机网卡都用网线直接连接交换机。主机Host1作为地址解析源节点，另一台主机Host2作为地址解析目标节点。

使用Windows操作系统自带的ARP工具软件作为实验工具。

## 实验内容

- 实验概况
  在一个子网内，地址解析源节点先删除 ARP 缓存表，然后向地址解析目标节点发出 ping
  测试命令，就会触发 ARP 协议去解析目标节点的网卡物理地址，解析后，解析地址会存放到
  其 ARP 协议缓存表内。通过前后对比 ARP 缓存表的解析地址变化，就可以间接证明目标节
  点的物理地址得到了解析。
  1. 配置主机 IP 地址，使得地址解析源节点和日标节点处于相同子网。
  2. 地址解析源节点删除 ARP 缓存表。
  3. 地址解析源节点用 ping 命令测试目标节点是否连通。
  4. 地址解析源节点查看 ARP 缓存表的目标地址解析信息。

- ARP 软件工具命令
  ARP 软件工具用来管理 ARP 缓存表,在命令行窗口下使用，常用命令
  1. 显示 ARP 缓冲区解析条目：`ARP -a`
  2. 删除 ARP 缓冲区解析条目：`ARP -d`

## 实验步骤

按照实验环境要求，完成实验拓扑结构连接，并打开相关设备电源。

1. 为 Host1 和 Host2 设置IP地址。设置IP地址，可不设网关地址。主机网卡IP地址设置如下：
   - Host1：IP 地址=192.168.0.12，子网掩码=255.255.255.0，网关空缺
   - Host2：IP 地址=192.168.0.10，子网掩码=255.255.255.0，网关空缺
2. Host2 触发对 Host1 的地址解析。
   - Host2 清除ARP缓存表：输入`arp -d`，再输入`arp -a`，发现没有出现`192.168.0.12`（Host1的IP地址）
   - Host2 发出ping连通测试命令：`ping 192.168.10.12`。结果为连通，时间`<1ms`
   - Host2 再次查看缓存表`arp -a`
   - 发现了`192.168.0.12`条目，其物理地址显示在后。
   - 核实物理地址：Host1 命令行输入`ipconfig /all`，发现该IP地址对应的物理地址与Host 2解析的物理地址完全一致。

## 实验小结

本次实验为我展现了网络层的一个很重要的事情：如何真实地定位到物理的网卡。IP地址是动态分配的（比如DHCP技术），这显然不能满足一个“唯一”的概念，将数据传送到相应的物理介质中。这时就要考虑到怎样将IP地址与物理地址形成映射的问题，于是引出了这个新的协议。

七层结构其实是一个得到数据，翻译、封装成邻接的下一层的数据的过程。这个系统相当复杂，需要许多协议，但是把握住这些协议的目的，学习起来应该就不会特别困难。

## 实验图片

实验结果：成功连通到另一台主机，并且可以见到。

![](./assets/7-2.png)



# 实验8 - 主机路由实验

## 实验目的

按照网际网组网原理，IP网络是个多跳网络，两个节点之间的传输将穿越多个IP子网，经过多个路由器，才能到达目标主机，而这一切均有赖于路由机制完成。

一般认为，路由是路由器的专利。实际上，主机上也设置了路由表，只是较为隐蔽。主机路由表是理解主机和路由器建立转发关系的
关键所在。实验构建两个 IP 子网，利用单路由器实现子网互联，验证主机缺省网关作用。

1. 深人了解主机路由机制。
2. 了解和掌握主机路由配置方法。

## 实验原理

### 路由器

路由器就是连接两个以上个别网络的设备。

路由器（英语：Router，又称路径器）是一种电讯网络设备，提供路由与转送两种重要机制，可以决定数据包从来源端到目的端所经过的路径（host到host之间的传输路径），这个过程称为路由；将路由器输入端的数据包移送至适当的路由器输出端（在路由器内部进行），这称为转送。路由工作在OSI模型的第三层——即网络层，例如网际协议（IP）。

### 主机路由原理

IP网络模型中，不存在孤立的IP子网络，所有子网都应通过路由器连在一起，因此每个IP子网对外均有一个进出口，称之为网关，网关相连就是路由器。根据源主机节点和目标节点所在子网关系，主机存在两种传输目标：子网内或子网外。

![](./assets/8-1.jpg)

图中`IP.S` 表示源主机节点地址，`IP2` 和`IP4` 是两个目标主机节点地址。`IP.R`是路由器1接入节点地址，`IP.S`，`IP2` 和`IP.R`同属一个IP子网，其网络地址为 `Network1`；`IP4` 在子网外，其网络地址为 `NetworkN`。为表述方便，用变量 `IP.NP`表示当前目标主机地址，变量`IP.NP` 表示下一跳地址；变量`M.S`表示源节点的网络掩码。

1. 源节点所在网络地址为`N.S-Network1`。目标节点所在网络地址`N.T=IP.T&&&M.S`。
2. 路由策略：
   如果 `N.S=N.T`，则`IP.NP=IP.T`；否则`IP.NP=IP.R`。
   对于目标主机 `IP2`， `N.T=Network1`，即`N.S=N.T`，则下一跳地址`IP.NP=IP2`。
   对于目标主机是`IP4`，`N.T= NetworkN`，即`N.S!=N.T`，则下一跳地址`IP.NP=IP.R`，应先把IP数据包发给路由器1，再通过路由器1转发出去，最终由路由器N发送给节点`IP4`。

主机路由表比较简单，只有两条条目，第一条以本机网络地址为目标，就直接访问该目标节点，用 Deliver direct 表示；第二条是缺省路由，即除本机网络外的其他网络地址，就转发到路由器接口地址。

下面用一个具体例子说明。

假定源主机网卡配置为：`IP. S=192.168.1.254`，`IP.R=192.168.1.1, M.S=255.255.255.0`；目标网卡一配置为：`IP2 =192.168. 1.2, M.S=255.255.255.0`；目标网卡二配置为`IP4=192.168.3.254, M. S=255.255.255.0`。

| Destination   | Mask            | Next hop       |
| ------------- | --------------- | -------------- |
| `192.168.1.0` | `255.255.255.0` | Deliver direct |
| `0.0.0.0`     | `0.0.0.0`       | `192.168.1.1`  |

子网`192.168.1.0/24` 是其自身所在的子网地址。

1. 当目标节点为`IP2`时，即`192.168.1.2`，计算其所属网络地址为`IP.T&&M.S = 192.168.1.2&&.255.255.255.0=192.168.1.0`，查表，符合第一条条目，就是直接发送给`192.168.1.2`。
2. 当目标节点是`IP4`时，即`192.168.3.254`，计算其所属网络地址为`IP.T&&M.S=192.168.3.254 &&255.255.255.0=192.168.3.0`，查表 ，不符合第一条条目，就只能执行缺省路由，直接发送给网关地址`192.168.1.1`。

## 实验环境

实验环境由一台路由器、两台计算机和一台交换机组成。由交换机担当网络连接设备，将路由器两个以太网端口和两台计算机网卡都用网线直接连接到交换机；通过串行线将主机`Host1` 串口`com`同路由器 `Console` 口连接起来，启用其超级终端作为路由器管理的操作平台。

主机 `Host2` 则使用命令行窗口用于连通测试。为处理方便，所有 IP 子网掩码都设置成 `255.255.255.0`，配置参数如下：

1. 路由器 A 设置：以太网接入端口`f0/0`，其IP地址设置为`192.168.1.1`；以太网接入端口`f0/1`，IP 地址设置为 `192.168.3.1`。
2. 主机 `Host1` 网卡地址设置为 `192.168.1.254`，网关地址设置成 `192.168.1.1`。
3. 主机 `Host2` 网卡地址设置为 `192.168.3.254`，网关地址设置成 `192.168.3.1`。

```
Router(config)#interface f0/0
Router(config-if)#ip address 192.168.1.1 255.255.255.0 （
Router(config-if)#no shutdown
Router(config)#interface f0/1
Router(config-if)#ip address 192.168.2.1 255.255.255.0
Router(config-if)#no shutdown
Router(config)#ip route 192.168.3.0 255.255.255.0 192.168.2.2 （目标网段IP地址、目标子网掩码、下一路由器接口IP地址）
Router(config)#ip route 192.168.3.0 255.255.255.0 f0/1（目标网段IP地址、目标子网掩码、送出接口）
```

## 实验内容

设置两个子网，子网间无法连通。用路由器直接连接这两个子网，为子网连通进行路由。但前提是主机设置IP地址时，必领将缺省网关设置为路由器以太网端口地址，以便通过路由器实现路由。

1. 主机路由实验
   - 配置主机 IP 地址，并将缺省网关地址设置为路由器以太网端口地址。
   - 配置路由器各个以太网端口地址，并启用路由功能。
   - 验证子网互通。测试两台主机是否连通.
2. 主机网关缺失实验
   - 在上述连通基础上，取消主机缺省网关，再测试两台主机是否连通。

## 实验步骤

【实验1：主机路由实验】

1. 配置`Host1`和`Host2`地址：

   `Host1`：`IP: 192.168.1.254; SubnetMask: 255.255.255.0; Gateway: 192.169.1.1` 

   `Host2`：`IP: 192.168.3.254; SubnetMask: 255.255.255.0; Gateway: 192.169.3.1` 

2. 测试子网连通性

   用`Host1`去`ping 192.168.3.254`，没有连通，原因是处于不同的网络地址，即使有网关地址，但网关节点不存在，设置无法起作用。

3. 查看`Host1`的主机路由表（`Route print`）发现缺省路由是`192.168.1.1`。

4. 配置路由器

   ```
   Router(config)#interface f0/0
   Router(config-if)#ip address 192.168.1.1 255.255.255.0 
   Router(config-if)#no shutdown
   Router(config-if)#exit
   Router(config)#interface f0/1
   Router(config-if)#ip address 192.168.2.1 255.255.255.0 ;分别为路由器（网关）的IP地址和子网掩码
   Router(config-if)#no shut
   Router(config-if)#exit
   Router(config)#ip routing ;启用路由功能
   Router(config)#exit
   ```

5. 测试子网连通性

   用`Host1`去`ping 192.168.3.254`，连通。路由器正在发挥路由转发功能。

【实验2：主机网关缺失实验】

1. 将`Host1`的默认网关地址删除，保存。
2. 测试子网连通性。发现无法`ping`，报错为`PING: 传输失败。常见故障。`

这是因为虽然存在网关，但是主机并不知道网关在何处，所以对于主机来说，网关也是不存在的。

## 实验小结

本次实验尝试了许多次都没有成功，最终发现是接线过程出了问题。再一次提醒自己，要非常细心才能做好这里的实验。

本次实验相当于做了一个简易的通信网络，初步使用了路由器，学习到了路由器的工作方式，受益匪浅。在传统TCP/IP术语中，网络设备只分成两种，一种为网关（gateway），另一种为主机（host）。网关能在网络间转递数据包，但主机不能转送数据包。在主机中，数据包需经过TCP/IP四层协议处理，但是在网关只需要到达网际层，决定路径之后就可以转送。在当时，网关与路由器还没有区别。在现代网络术语中，网关与路由器的定义不同。网关能在不同协议间传输资料，而路由器是在不同网络间传输资料，相当于传统所说的IP网关（IP gateway）。

然而，真实的网络比我们想象的都要复杂。如果这样穷举地去寻找目标网络，不知要找到猴年马月。所以现实中还有各种路由算法，比如距离向量算法中的Bellman-Ford的应用，再比如连接状态算法中的Dijkstra的应用等等。

互联网是人类最伟大的发明。它是工程、数学、计算机科学的结晶。

## 实验图片

路由器的接线：

![](./assets/8-2.jpg)

连通成功：

![](./assets/8-4.png)

# 实验9 - 静态路由实验

## 实验目的

静态路由，是指由人工根据网络拓扑结构来创建路由表。路由器需要依靠路由表来转发IP数据包，该实验是路由器实验中最基础的实验，后续的几个实验都以静态路由为基础。静态路由也是理解路由原理最直观的途径。

实验模仿两个远程子网的互联，两个子网在本地各接一个路由器,路由器之间用远程网络相连，使用静态路由实现远程子网互联。

1. 深入了解IP路由基本原理。
2. 了解和掌握配置静态路由配置方法。

## 实验原理

### 静态路由的原理

静态路由是指由手工配置的路由信息。当网络的拓扑结构或链路的状态发生变化时，需要手工去修改路由表中相关的静态路由信息。

- 静态路由信息在缺省情况下是私有的，不会传递给其他的路由器。当然，网管员也可以通过对路由器进行设置使之成为共享的。
- 静态路由一般适用于比较简单的网络环境，在这样的环境中，网络管理员易于清楚地了解网络的拓扑结构，便于设置正确的路由信息。

静态路由通过人工编辑方法，在路由器中直接设置路由表。静态路由表可以由多条路由条目组成。例如：

| 目标网络     | 掩码 | 下一跳         |
| ------------ | ---- | -------------- |
| 本地网络地址 | M.S  | Deliver direct |
| 非本地网络   | M.S  | IP.R           |

如上一节所介绍，路由表分为两类路由条目：第一类目标网络是本地网络地址(Local Network Address)，指直接跟路由器端口相连的IP 子网网络地址，M.S是网络掩码。路由器就会直接发送IP数据包给该目标节点；第二类目标网络是非本地网络(Network Address），路由器会转发到IP.R地址，该地址往往是通往目标节点的邻居路由器接入地址。

静态路由最大的优点是能

### 子网与掩码

子网掩码也称为网络掩码，地址掩码和子网遮罩。 它用于指示IP地址的哪些位标识主机所在的子网，哪些位标识为主机的位掩码。 子网掩码不能单独存在，必须与IP地址一起使用。 子网掩码仅具有一项功能，即将IP地址分为两部分，即网络地址和主机地址。子网掩码是一个32位地址，用于屏蔽IP地址的一部分，以区分网络ID和主机ID，并指示IP地址是在局域网上还是在广域网上。

#### 子网掩码的功能

子网掩码是一个32位地址，这是一种与IP地址结合使用的技术。 它具有两个主要功能。 一种是屏蔽IP地址的一部分，以区分网络ID和主机ID，并指示IP地址是在局域网上还是在远程网络上。 第二个是将大型IP网络划分为若干个小型子网。

子网的使用是为了减少IP的浪费。 因为随着Internet的发展，创建了越来越多的网络，有些网络多达数百个，而有些只有少数，这浪费了大量IP地址，因此必须划分子网。 使用子网可以提高网络应用程序的效率。

通过计算机的子网掩码**判断两台计算机是否属于同一网段的方法**是将计算机的十进制IP地址和子网掩码转换为二进制形式，然后执行二进制AND计算（全1则得1，不全1则得0）。 如果结果相同，则两台计算机属于同一网段。

在本实验中，两个主机的网关四段IP地址的第三段是不同的，因此用上述方法得到的结果也是不同的，故不属于同一网段。实验8与实验9都在不同的子网也就是不同的网段中，前者是通过同一个路由器，后者是通过不同的路由器。

### 静态路由的优缺点

**优点**：

- 网络安全保密性高。动态路由因为需要路由器之间频繁地交换各自的路由表，而对路由表的分析可以揭示网络的拓扑结构和网络地址等信息。因此，网络出于安全方面的考虑也可以采用静态路由。
- 揭示路由的基本原理，因为路由由手工配置出来，一般适用于比较简单的网络环境，**工程实践采用动态路由为主**。

**缺点**：

大型和复杂的网络环境通常不宜采用静态路由。一方面，网络管理员难以全面地了解整个网络的拓扑结构；另一方面，当网络的拓扑结构和链路状态发生变化时，路由器中的静态路由信息需要大范围地调整，这一工作的难度和复杂程度非常高。

### 路由器串口连接配置

虽然本实验中采用默认配置即插即用，但正常情况下串行连接两路由器应当考虑到串口的配置。

1. 在全局模式下键入命令`interface serial 0`进入到串行接口配置模式下。
2. 每一个连接的串行接口都必须有一个IP地址和子网掩码来**转发**IP数据包，我们可以在接口配置模式下键入`ip address <IP address> <netmask>`的命令来配置串行接口的IP地址。
3. 如果串行接口连接的是一个DCE设备，我们还需要为串行接口配置一个时钟频率，如果是DTE设备则不需要。默认情况下，cisco路由器是一个DTE设备，但是我们可以通过使用命令来将其配置成DCE设备。

### DCE与DTE

DCE：数据通信设备

DTE：数据终端设备

- 只有在同步通信方式的线路上才会有时钟速率，同步通信时需要线路两端进行信号发送频率的同步，也就是同步的时钟，在实际工程中由协议转换器、modem等线路控制设备来提供，而实验环境中没有专门的线路控制设备，所以由其中的一台路由器的`serial`接口来提供。DCE一端的确定是由路由器之间的cable的线序来 决定的，所以`back to back`的线缆都标明DCE和DTE。
- 只有标明DCE一端的才需要设置clock rate
- 同步时钟的频率和带宽没有直接的联系，64000指的是以**64000比特率时间间隔添加发送同步位**。
- 可以设置其他数值，只要是两端都能达到那个标准即可，对通信没有影响

对于标准的串行端口，通常从外观就能判断是DTE还是DCE，DTE是针头（俗称公头），DCE是孔头（俗称母头），这样两种接口才能接在一起。

### 命令：`Tracert`

`Tracert`或`Traceroute`是测试报文从发送端到目的地所经过的路由的方法。它能够直观展现报文在转发的时候所经过的路径。

`Tracert`基于ICMP协议来实现。当网络出现故障时，用户可以使用`Tracert`确定出现故障的网络节点。

> 1、源端（`SwitchA`）向目的端（日志主机）发送一个UDP报文，TTL值为1，目的UDP端口号是大于30000的一个数，因为在大多数情况下，大于30000的UDP端口号是任何一个应用程序都不可能使用的端口号。
>
> 2、第一跳（`SwitchB`）收到源端发出的UDP报文后，判断出报文的目的IP地址不是本机IP地址，将TTL值减1后，判断出TTL值等于0，则丢弃报文并向源端发送一个ICMP超时（Time Exceeded）报文（该报文中含有第一跳的IP地址`10.1.1.2`），这样源端就得到了`SwitchB`的地址。
>
> 3、源端收到`SwitchB`的ICMP超时报文后，再次向目的端发送一个UDP报文，TTL值为2。
>
> 4、第二跳（`SwitchC`）收到源端发出的UDP报文后，回应一个ICMP超时报文，这样源端就得到了`SwitchC`的地址（10.1.2.2）。
>
> 5、以上过程不断进行，直到目的端收到源端发送的UDP报文后，判断出目的IP地址是本机IP地址，则处理此报文。根据报文中的目的UDP端口号寻找占用此端口号的上层协议，因目的端没有应用程序使用该UDP端口号，则向源端返回一个ICMP端口不可达（Destination Unreachable）报文（该报文含有目的端的IP地址10.1.3.2）。
>
> 6、源端收到ICMP端口不可达报文后，判断出UDP报文已经到达目的端，则停止`Tracert`程序，从而得到数据报文从源端到目的端所经历的路径（`10.1.1.2`；`10.1.2.2`；`10.1.3.2`）。

## 实验环境

本次实验的拓扑结构如图所示：

![](./assets/9-5.jpg)

实验环境由两台路由器、两台计算机和一台交换机组成，模拟两个远程子网互联。使用单根串行交叉线将两个路由器的串口对接起来,代表路由器之间的远程网络;将路由器以太网端口和两台计算机网卡都用网线直接连接到交换机，由交换机担当网络连接；通过串行线将计算
机串口 com 同路由器 console 口连接起来，两台计算机超级终端将作为路由器管理的操作平台。

为处理方便，所有IP子网掩码都设置成255.255.255.0；其他配置参数如下：

1. 路由器A配置。以太网端口 `g0/1`，IP 地址设置为`192.168.1.1`；串口 `s0/0/1`，IP 地址设置为 `202.168.1.1`。
2. 路由器B配置。以太网端口 `f0/1`，IP 地址设置为`192.168.2.1`；串口 `s0/0/1`，IP 地址设置为 `202.168.1.2`。
3. 主机 host1 网卡地址设置为`192.168.1.254`，网关地址设置成`192.168.1.1`。
4. 主机 host2 网卡地址设置为`192.168.2.254`，网关地址设置成 `192.168.2.1`。

## 实验内容

1. 按照实验拓扑图连接线路。
   - 两个以太网子网各自在本地连接一个路由器，然后将两个路由器的串口连接起来配置成远程连接子网，使得两个以太网子网经过该连接子网实现互通。

2. 进行端口配置
3. 验证子网是否互连互通。

## 实验步骤

1. 配置主机 Host1 和 Host2网卡地址，测试连通性

   - 配置主机网卡地址。
     `Host1`：IP 地址：`192.168.1.254`，子网掩码：`255.255.255.0`，网关：`192.168.1.1`

     `Host2`：IP 地址：`192.168.2.254`，子网掩码：`255.255.255.0`，网关：`192.168.2.1`

   - 测试子网连通。

     Host1 打开命令行窗口，测试 Host2是否连通.
     输人`ping 192.168.2.1`，没有连通，因为两个节点在不同两个子网中，网关节点还不存在。

2. 配置路由器A与路由器B

   ```
   
   routerA(config)#int g0/1
   routerA(config-if)#ip addr 192 168.1.1 255.255.255.0
   routerA(config-if)#no shut
   routerA(config-if)#exit
   routerA(config)#int s0/0/1
   routerA(config-if)#ip addr 202.168.1.1 255.255.255.0
   routerA(config-if)#no shut
   routerA(config-if)#exit
   ; 以上为接口配置，以下为路由配置
   routerA(config)#ip route 192.168.2.0 255.255.255.0 202.168.1.2 <Dest. addr.><subnet mask><NextHop add.>
   routerA(config)#exit
   
   ; 可以通过`routerA#sh ip route`查看配置结果。
   ; 路由器B的配置方法相同，在此处省略。
   ```

3. 测试子网连通性（Host1）

   `ping 192.168.2.254 `：连通

   `tracert 192.168.2.254`：经过`192.168.1.1`和`202.168.1.2`两个中间节点，分别是Host1的网关地址和路由器B的串口地址。

## 实验小结

本次实验是实验7、实验8的升级版本，具有工程实践的价值。目前对于在实验室接线，已经比之前的实验都有了经验，大概率不会被接线所困扰。实验原理因为符合对于因特网的常识性的认识，也比较好理解。实验中出现了`ping`命令的比较出乎意料的回复，`ping 192.168.2.254`，居然收到了`169.254.253.114`的回复，这是自动地址。重新配置Host1的网关后，才解决了问题。

总而言之，动手做和学习原理是两码事。接线的环境有时会非常复杂，调试错误的方法也多种多样。需要多多积累实践经验，才能更好地学习理论知识。

## 实验图片

实验结果：

![](./assets/9-0.jpeg)

路由器接线：

![](./assets/9-3.jpg)

路由器接口配置：

![](./assets/9-4.jpg)



# 实验10 - 蓝牙（个域网）通信实验

## 实验目的

随着IT技术广泛应用，各类智能设备层出不群，蓝牙（Bluetooth）能耗比 Wi-Fi 要低，更为普遍地使用在嵌入式智能设备中，用于软件更新和数据通信。熟练掌握蓝牙技术，具有很强的实用价值。实验利用智能手机具有的蓝牙模块，同笔记本电脑进行通信，展现个域网通信特点。

- 了解个域网组网原理
- 熟练掌握蓝牙组网使用步骤

## 实验原理

### 蓝牙技术

蓝牙，一种无线通讯技术标准，用来让固定与移动设备，在短距离间交换资料，以形成个人局域网（PAN）。其使用短波特高频（UHF）无线电波，经由2.4至2.485 GHz的ISM频段来进行通信。1994年由电信商爱立信（Ericsson）发展出这个技术。它最初的设计，是希望创建一个RS-232数据线的无线通信替代版本。它能够链接多个设备，克服同步的问题。

蓝牙技术目前由蓝牙技术联盟（SIG）来负责维护其技术标准，其成员已超过三万，分布在电信、电脑、网络与消费性电子产品等领域。IEEE曾经将蓝牙技术标准化为IEEE 802.15.1，但是这个标准已经不再继续使用。

个域网主要用途为智能设备提供近距离的通信，代替有线电缆，实现智能设备之间，以及智能设备与计算机系统之间的数据交换。无线网络技术种类繁多，蓝牙作为一种无线个域网技术，被广泛地安装在各类智能设备上,应用前景十分广阔。

蓝牙采用一对一的通信模式，只能在两个设备之间进行通信。为避免非许可访问，采用主从安全模式，一台蓝牙设备作为主设备，为访问者设置口令，另一台蓝牙设备作为从设备，向主设备发起通信连接，输人预设口令后，通过建立连接，然后才能进行数据通信。

## 实验环境

本次实验采用手机和电脑进行蓝牙文件互传进行。由于苹果手机不开放蓝牙给文件传输之用途且实验室台式机不支持蓝牙，仅可以使用安卓智能手机与笔记本电脑完成实验。

## 实验内容

实施手机和计算机蓝牙部件的配对，通过无线蓝牙相连组成一个个域网络，建立后进行文件传输。

1. 设置智能手机为蓝牙模块主设备，在主设备上设置访问口令。
2. 建立蓝牙通信连接，以计算机蓝牙模块作为从设备，向主设备发起通信连接，输入预设口令，通过后建立网络连接。
3. 文件传输，借助蓝牙连接在计算机和手机之间进行文件传输。
4. 解除蓝牙通信连接，删除个域网。

## 实验步骤

1. 开启智能手机蓝牙，置状态为开，记录手机的蓝牙设备名
2. 建立蓝牙通信连接
   - 笔记本创建蓝牙通信连接配对请求。
   - 选择添加蓝牙设备，后在搜索列表中选择手机的蓝牙设备名。
   - 在手机上点击“配对”。
   - 在笔记本中确认配对。
3. 文件传输
   - 在蓝牙设置页的下方，点击“使用蓝牙传输文件”。
   - 在设备列表中选择实验手机，下一步。
   - 选择文件。
   - 手机端接收文件：对话框点击“接收”。
   - 验证文件确实为所选文件。
4. 删除蓝牙通信连接

## 实验小结

本次实验虽然简单，但是在生活中有很多的应用场景。现在经常会碰到手机和电脑无法很方便地传输文件的问题，影响工作效率。虽然蓝牙建立个域网很方便，但是使用起来也有诸多限制，如苹果手机与Windows电脑不能互传文件、配对时间长、步骤复杂等等。现在在诸多设备间传输文件、信息，多用微信的“文件传输助手”了。这种方式把自己的文件先发送到微信的服务器上，再在另外一个设备上从服务器中下载下来。虽然有些南辕北辙，但当今的5G、千兆宽带早已将这些问题解决，使用起来也很方便。当然，这就不是直接使用数据链路层传输数据了。

## 实验图片

**todo**: add pictures here

# 实验11 - 组播路由实验

## 实验目的

组播是一对多的传输模式，即一个节点向组播地址发送一个IP数据包，所有该组播的成员都将接收这个 IP数据包，具有较高传输效率。组播应用非常广泛，视频会议就是组播的典型应用，正确使用组播对于提高网络传输效率非常有价值。

但组播不会自动跨域子网，需要对路由器进行适当设置。实验模仿两个远程子网的互联，两个子网各接一个路由器，路由器之间用远程网络相连，安排一个组播发送节点和两个组播接收节点，配置路由器使得组播能跨越子网。

- 了解组播协议基本原理
- 掌握路由器组播配置技能

## 实验原理

### 组播是什么

组播是一种通过使用一个多播地址将数据在同一时间以高效的方式发往处于TCP/IP网络上的多个接收者的协议。此外，它还常用来与RTP等音视频协议相结合。

通常，在传统的网络通讯中，有两种方式，一种是源主机和目标主机两台主机之间进行的“一对一”的通讯方式，即单播，第二种是一台源主机与网络中所有其他主机之间进行的通讯，即广播。那么，如果需要将信息从源主机发送到网络中的多个目标主机，要么采用广播方式，这样网络中所有主机都会收到信息，要么，采用单播方式，由源主机分别向各个不同目标主机发送信息。可以看出来，在广播方式下，信息会发送到不需要该信息的主机从而浪费带宽资源，甚至引起广播风暴：而单播方式下，会因为数据包的多次重复而浪费带宽资源，同时，源主机的负荷会因为多次的数据复制而加大，所以，单播与广播对于多点发送问题有缺陷。

在此情况下，组播技术就应用而生了。组播又称多目标广播、多播。网络中使用的一种传输方式，它允许把所发消息传送给所有可能目的地中的一个**经过选择的子集**，即向明确指出的多种地址输送信息。是一种在一个发送者和多个接收者之间进行通信的方法。

### 互联网组播协议

IP 组播地址指位于 224.0.0.0到 239.255.255.255 之间的IP地址段。组播在一个IP子网内部使用没任何问题，只要直接使用以太网组播地址，其成员均能接收IP数据包。

但当组播跨越IP子网时，路由器并不会自动支持组播路由。组播地址使用始终处于动态变化中，不断有成员加入，也不断有成员离开，无法像单播地址那样事先在路由器中设置组播路由。

组播协议包括组成员管理协议和组播路由协议。组成员管理协议用于管理组播组成员的加入和离开。互联网组播协议（IGMP） 是组成员管理协议，运行在主机和组播路由器之间。路由器为建立组播路由必须了解每个组员在网络中的分布，当新成员加入某个组播时，通知路由器，由路由器设置该组播地址，一旦接收到该组播地址数据包就予以转发；日常会定时主动查询组播成员，以维护组播成员构成状况，适应组播成员的动态变化。

### IGMP运行原理

1. 当主机上的一个进程加入组播组时，就必须发送
   一个IGMP请求消息给路由器，让该主机加入组播组。IGMP 协议以主机身份方式而非进程方式加入组播组，多个进程加入同一组播，只需要发送一条 IGVP 请求消息。进程退出组播组时，则主机不需要发送 IGMP 诮求消息。
2. 组播路由器收到 IGMP 请求消息。路由器为每个组播维护一个组播组成员表。将发送请求的主机加人组播组成员表中。
3. 组播数据报转发。当路由器收到组播数据报时，就会将该数据报转发到属于组播组成员的主机所连接的端口上。
4. 组播路由器定时发送 IGMP 查询消息来维护组播组成员表。

### 协议无关组播（PIM）

PIM（Protocol Independent Multicast）称为协议无关组播。这里的协议无关指的是与单播路由协议无关，即PIM不需要维护专门的单播路由信息。作为组播路由解决方案，它直接利用单播路由表的路由信息，对组播报文执行RPF（Reverse Path Forwarding，逆向路径转发）检查，检查通过后创建组播路由表项，从而转发组播报文。

- 稀疏模式：此协议使用以下假设：在多播组中，所有接收者将稀疏分布在环境中。 它主要用于广域使用。 该协议支持共享树的使用，共享树只是植根于特定节点的多播分发树。 它还支持基于源树的使用，对于每个将数据传输到多播组的源，它都有一个单独的多播分发树。 在稀疏模式下，重要的是具有一种机制来发现根节点或集合点。
- 密集模式：此协议做出与稀疏模式相反的假设。 假定在多播组中，所有接收者都在环境中密集分布。 通过泛洪多播流量，它可以构建最短路径树，并且当不存在接收方时，也可以在树枝上进行修剪。 与稀疏模式不同，该协议仅基于基于源的树，因此不依赖于会合点。 这使得密集模式更易于实现和部署。 但是，密集模式的缩放特性很差。

## 实验环境

实验环境主要由两台路由器、三台计算机和两台交换机组成。使用单根串行交叉线将路由器A同路由器B的串口对接起来，模拟远程传输网络；将路由器 A 以太网端口和主机Host1 用网线直接连接到一个交换机 Switch1；将路由器B以太网端口和主机 Host2 和 Host3
用网线直接连接到另一个交换机 Switch2；通过串行线将主机 Host1 和 Host2 串口com同路由器console口连接起来，使用超级终端充当路由器管理的操作平台。运行**组播测试工具软件**用于组播测试。

也即，在静态路由实验的基础上增加一个Host3，模拟与组播组中的信号发送者在同一个子网中的情况。

实验拓扑图如图所示：

![](./assets/10-1.jpg)

为处理方便，所有IP子网掩码都设置成255.255.255.0，配置参数如下：

```
路由器 A：以太网端口 f0/1, IP地址设置为192.168.1.1; 串口 s0/0/1, IP 地址设置为 202.168.1.1

路由器 B：以太网端口 f0/1, IP地址设置为192.168.2.1; 串口 s0/0/1, IP 地址设置为 202.168.1.2

hostl: 网卡地址设置为192.168.1.254, 网关地址设置成192.168.1.1; 运行组播接收器 McastReceiver。

host2: 网卡地址设置为192.168.2.254, 网关地址设置成192.168.2.1; 运行组播发送器 McastSender。

host3: 网卡地址设置为192.168.2.10, 网关地址设置成192.168.2.1; 运行组播接收器 McastReceiver。
```

此外，还需要使用组播测试工具`MCastSender`与`MCastReceiver`。

## 实验内容

1. 先建立两个远程子网的互联，也即《实验9 - 静态路由实验》。
2. 按照本次实验拓扑加入Host3.
3. 在三台主机上在三台主机上运行组播软件，Host2 运行组播发送器以发送组播数据包，Host1 和 Host3运行组播接收器以接收组播数据包。预期效果：可以看到 Host3 可以接收包，它和Host2 同处一个交换机；而Host1 不能收到，尽管通信是连通的，主要是组播被路由器阻隔，路由器没配置转发组播。
4. 配置路由器支持组播转发。是路由器的每个端口都采用PIM组播路由协议。

## 实验步骤

**按照《静态路由实验》将Host1与Host2的两个子网连通。**

1. 将Host3接入交换机，配置网卡如下：

```
Host3： IP addr 192.168.2.10 S.M. 255.255.255.0 Gateway 192.168.2.1 (same as Host2's Gateway)
```

2. 启动组播发送器。Host2 打开`MCastSender`，开始发送组播数据。

```
组播地址: 224.1.1.1 ; 端口: 9000 ; 发送速度: 512 ; 包尺寸: 1024 
```

3. 启动Host3组播接收器。Host3 打开`MCastReceiver`，开始接收组播数据。观察到正在接受组播数据，且注明为从`192.168.2.254`主机获得。
4. 启动Host1组播接收器。无数据接收，这是因为还没有配置路由器进行组播转发。
5. 配置路由器进行组播转发。

```
在路由器A、路由器B的所有端口配置模式，采取以下的设置：
ip multicast-routing
ip pim sparse-dense-mode
```

此处是本次实验的难点所在。根据实验指导书上的`ip pim dense-mode`来做，会频繁出现提醒`WARNING: "ip multicast-routing" is not configured`。起初云里雾里，没有尝试先配置`ip multicast-routing`，反而是不断尝试后面的`ip pim dense-mode`，结果总是报错。

后来在[思科的在线说明书](https://www.cisco.com/en/US/docs/switches/lan/catalyst3850/software/release/3se/consolidated_guide/b_consolidated_3850_3se_cg_chapter_0101000.html#)中找到了解决方法：

```
SUMMARY STEPS
1.    enable
2.    configure terminal
3.    ip multicast-routing
4.    interface interface-id
5.    ip pim {dense-mode | sparse-mode | sparse-dense-mode}
6.    end
7.    show running-config
8.    copy running-config startup-config
```

此处的`sparse-dense-mode`是说`dense-mode`或者`sparse-mode`，根据实际情况来调整。

至此组播路由转发功能已经配置结束。

6. 查看Host1组播接受情况。发现可以接收到组播数据，且注明由`192.168.2.254`（Host2）获得，组播实验成功。

## 实验小结

## 实验图片

Host3 接收组播数据：

![](./assets/11-1.jpg)

Host1 接收组播数据：

 ![](./assets/11-2.jpg)



# 实验12 - 动态IP地址分配DHCP实验

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片

