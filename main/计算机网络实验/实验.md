# 1952060 张佰一 计算机网络实验报告 2021年-2022年秋季学期

[toc]

# 实验1 - 进程运行原理实验

## 实验目的

计算机网络交互主体是计算机进程，了解进程运行的基本原理，对于理解端与进程关系十分重要。本实验利用操作系统的进程管理软件来展示进程的生命周期。

- 了解进程的基本概念。
- 了解进程的基本运行原理，掌握基本进程管理技能。

## 实验原理

计算机程序是指用计算机语言开发的代码文件，一般需要编译成可执行代码。程序以文件方式存储在操作系统的文件系统中。进程指程序装载到内存中进行运行的代码段。现代操作系统可以对进程实施管理。

### 任务管理进程（Windows）
操作系统的任务管理器提供了用户计算机上正在运行的程序和进程的相关信息，也显示了最常用的度量进程性能的单位。使用任务管理器，可以打开监视计算机性能的关键指示器， 快速查看正在运行的程序的状态，或者终止已停止响应的程序。也可以使用多个参数评估干在运行的进程的活动， 以及CPU 和内存使用情况的图形和数据。任务管理器中，“应用程序”选项卡显示正在运行程序的状态，用户能够结束、切换或者启动桯序。”进程”选项卡显示正在运行的进程信息。

### 进程运行原理

1. 进程创建。程序一旦运行就成为进程，每个进程都分配一个唯一的进程编号，但其进程编号并不固定。
2. 进程运行。现代操作系统允许同时运行多个进程，每个进程运行时需要使用多种计算机部件资源，其中 CPU 资源必不可少，当 CPU 核数量小于并发进程数量时，操作系统会对CPU 实施共享，将CPU 运行时间划分成多个时间片，分配给各个进程提供运行，使所有进程都能同时运行，进程的并发运行并不是真正意义上的并发。
3. 进程终止。一般通过程序提供的退出按钮终止进程,也可以通过进程管理命令或软件结束进程

### 操作进程

1. Tasklist 命令：用于显示运行在本地或远程计符机上的所有任务的应用程序和服务列表，带有过程TO ; 可以监控川户操作。
2. Taskkill命令：用于结束一个或多个任务或进程。可以根据进程ID 或图像名来结束进程。（简写：Tskill）

备注：**这两个命令需要管理员身份的权限。**

### 网络进程

网络进程与一般进程具有基本相同的属性，唯一不同的特性是网络进程需要开启一到多个传输端口号（传输层：0-65535，其中0-1023 为保留端口号或系统端口）。一般来说，对于C/S 或B/S 架构的网络，客户端网络进程至少开启一个端口号，用于接收数据或发送数据。服务端网络进程则可能至少开启两个端口号，一个用于接收客户端的数据，一个用于发送数据给客户端。在Windows 系统中，可以使用相关命令查看正在使用的端口号。

## 实验环境

实验由一台安装 Windows 10 企业版操作系统的计算机担当，使用其任务管理器软件实施进程管理实验，也可以使用其他操作系统作为操作平台。

## 实验内容

实验将围绕进程的管理内容展开,使用任务管理器软件进行进程管理,通过鼠标进行操作，从屏幕观看操作结果。

1. 多次运行同一个特定应用程序，看到该程序可以以多个不同的进程同时运行，每次运行，进程号会不一样。
2. 通过应用程序界面关闭程序，看到其进程被结束
3. 通过任务管理器关闭进程,终止应用程序的运行。

## 实验步骤

1. 打开任务管理器（`ctrl`+`alt`+`delete`）
2. 观察任务管理器窗口，可见名称、PID、状态、用户名、CPU、内存、描述的字段，用以描述一个进程。
3. 打开命令提示符（`cmd`），打开浏览器。
4. 查看刚刚打开的程序进程信息。可见`cmd`创建了一个进程，Chrome则创建了许多进程。
5. `> Taskkill 20900`命令，将该进程结束

## 实验小结

通过OS的学习，易知计算机处理任务其实是在进程和线程上工作，为了便于管理员用户管理，操作系统给用户提供了查看正在运行的程序和进程的相关信息。我们实验就通过这个入口查看所需信息。

## 实验图片

![](./assets/1-1.png)



# 实验2 - 网络端地址实验

## 实验目的

网络端地址用于标识计算机网络进程，网络进程是计算机网络传输主体，由于语言表达上问题，容易误将计算机作为计算机网络的传输主体。明确了网络传输主体，就容易理解计算机网络各项具体功能处理的基本原理。本实验利用浏览器上网这个最为熟悉的应用，呈现网络端地址作用。

1. 明确计算机网络交互的主体是进程。计算机网络两台计算机之间的交互，实质上是两个进程之间的交互。
2. 了解网络端地址构成及使用。端地址是用于标识网络上任意一台计算机上的任意个网络进程，具有唯一性和不变性，只有通过访问网络端地址才能通过网络同该进程交互。但在日常使用应用协议时，常常忽略端口地址，自动采用该应用协议缺省端口地址作为网络端地址。

## 实验原理

计算机网络正如其名字所揭示的一样，就是用于计算机之间的交互，但只是宽泛的表述，现代计算机中真正执行主体实际上是各个进程。所谓两台计算机交互，按照计算机网络通信交互模型，必然是某两个进程之间的交互。网络进程的识别是通过网络端地址来实施。端地
址格式如下：
`IP:PORT`
用于标识互联网任意一个节点上的任意一个网络进程，IP指主机 IP 地址，也可以使用域名，域名会被域名系统自动转换成 IP 地址；PORT 指该进程的网络端口号，进程运行时会被注册并建立与进程号的映射关系，通过端口号，可以访问到对应进程，进行网络交互。

### 网络端口地址的划分

| 端口范围   | 作用                                                         |
| ---------- | ------------------------------------------------------------ |
| 0~1023     | 【系统端口】这些端口只有系统特许的进程才能使用。             |
| 1024~5000  | 【用户端口】临时端口，一般的应用程序使用1024到4999来进行通讯。 |
| 5001~65535 | 【用户端口】服务器端口，用来给用户自定义端口。               |

### 常见的端口号（TCP/UDP）

| 服务名称 | 端口号                                                       |
| -------- | ------------------------------------------------------------ |
| FTP      | FTP使用的端口号是20和21。20端口用于数据传输，21端口用于控制信息的传输，控制信息和数据能够同时传输，这是FTP的特殊之处 |
| TFTP     | 端口号69，使用UDP的连接TFTP（Trivial File Transfer Protocol,简单文件传输协议）是TCP/IP协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。 |
| UDP      | 端口53：DNS 域名解析服务；                                   |
| TCP      | 端口80：HTTP 超文本传输服务；                                |
| TCP      | 端口443：HTTPS 加密的超文本传输。                            |
| DHCP     | 服务器端的端口号是67                                         |
| DHCP     | 客户机端的端口号是68                                         |
| POP3     | POP3接收协议，POP3客户端使用SMTP向服务器发送邮件。POP3使用的端口号是110。 |
| SMTP     | 端口号是25，SMTP真正关心的不是邮件如何被传送，而只关心邮件是否能顺利到达目的地。 |
| Telnet   | 端口号23：测试端口号，可以使用telnet命令来测试端口号是否正常打开还是关闭。 |

## 实验环境

由一台计算机担当实验设备，计算机必须连接互联网。使用Chrome浏览器。

## 实验内容

任何开放的互联网 Web 网站按照业界习惯，都使用`80`端口地址作为 HTTP 协议的端地址。浏览器地址栏支持端地址使用，当没有输人端地址时，就会自动采用应用协议的缺省端地址，HTTP 协议的缺省端地址是`80`。实验使用 Chrome浏览器访问互联网上任意一个网站，通过设置网络端地址,来验证其作用。主要实验内容：

1. 端地址设置成`81`端口时，浏览器无法浏览网页。
2. 端地址设置成`80`端口时，浏览器可以正常浏览网页。

## 实验步骤

*由于学校门户网站已经升级为`HTTPS`协议，所以本实验在`HTTPS`版本中的门户网站环境下进行。*

访问`https://www.tongji.edu.cn:81`：

```
无法访问此网站
www.tongji.edu.cn 拒绝了我们的连接请求。
请试试以下办法：

检查网络连接
检查代理服务器和防火墙
ERR_CONNECTION_REFUSED
```

访问`https://www.tongji.edu.cn:80`：

```
此网站无法提供安全连接
www.tongji.edu.cn 发送的响应无效。
尝试运行 Windows 网络诊断。
ERR_SSL_PROTOCOL_ERROR
```

*这是因为`HTTPS`默认的端口号是`443`而不是`80`。*

访问`http://www.tongji.edu.cn:80`：

可以访问，但跳转到了`HTTPS`协议的网站。

访问`https://www.tongji.edu.cn:443`：

可以访问。

## 实验小结

本次实验，主要是要学习到计算机网络的思考方式：进程和进程之间交互、端口和进程的联系。

计算机上网是怎么上的？这个问题我目前的理解是：计算机连接到互联网会被分配一个公网IP，这个IP相当于计算机的身份证。但是根据网络连接实际上是网络进程之间的连接这一知识，只用一个身份证是不够的，还需要一个端口号来区分不同的进程。当我们访问一个网页，就是用我们的`IP:PORT`这个进程唯一的标识符去访问服务器的`IP:443`的进程，两个进程如此完成交互。

## 实验图片

![](./assets/1-4.png)



# 实验3 - 网络线的制作和测试实验项目

## 实验目的

- 了解局域网组网原理
- 理解掌握以太网组网步骤
- 了解双绞线网线的制作过程

## 实验原理

有三种形式的导线的能帮助减小电气噪声的干扰，其中除了同轴电缆就是双绞线。双绞线有两根绞在一起的导线构成。每一根导线都有一层起绝缘作用的塑料包裹，防止导线之间短路。屏蔽双绞线（STP）使用更细更柔韧的金属屏蔽层包裹一对或多对双绞线，其优点是柔韧性比同轴电缆要好，同时其抗电磁噪声干扰的能力要比非屏蔽双绞线强。

本实验中使用的**五类双绞线**是用于网络的无屏蔽双绞线，数据速率在`100Mbps`左右。

## 实验材料

两个**TJ45水晶头**，一段五类双绞线。

## 实验内容

使用工具和材料制作双绞线直通线，并用测试设备测试。

## 实验步骤

1. 用压线钳将网线一段的套管皮剪掉`2cm`
2. 按照**白橙、橙、白绿、蓝、白蓝、绿、白棕、棕**的线序将网线排列好
3. 把网线摆平拉直，剪齐留下`1.5cm`
4. 水晶头弹簧片一面向下，将线插入其中，使线紧紧地顶在顶端
5. 将水晶头插入压线钳套住水晶头用力压，使网线和水晶头卡在一起
6. 使用以太网测试工具，将网线线两端头插入网线测试仪。可以观察到**表示八个通路的指示灯依次闪烁**，测试通过，说明制作成功。

## 实验小结

本次实验动手为主。一直以来我对于双绞线的认识都是即插即用，此次实验带给我一个从横截面观察双绞线内部构造的机会。双绞线按照严格的角度和力度绞在一起，末端和水晶头连接的时候牵扯到不同颜色的顺序和压紧的工艺，所以人工可能比机器要靠谱。但是我的第一次尝试却失败了，原因是剪齐线的环节没有把握好，某根线的长短和其他线不一样，导致这根线的指示灯没有亮。一方面感叹测试器相当好用，可以迅速知晓错误原因；另一方面感叹这个工作确实需要相当的耐心。

最后用自制的网线完成了另一个组网的实验，非常有成就感。

## 实验图片

![3-1](.\assets\3-1.jpg)

![3-2](.\assets\3-2.jpg)

![3-3](.\assets\3-3.jpg)



# 实验4 - IOS基本操作实验

## 实验目的

- 了解IOS基本知识
- 理解实验网络物理组网原理
- 登录路由器
- 熟悉IOS中的各种命令的用途
- 熟悉IOS命令的使用方法

## 实验原理

### IOS操作系统简介

IOS(Internetwork Operating System)，全称是网际操作系统，由思科公司(CISCO) 首先提出和使用，主要运行在思科网络设备上,包括路由器、交换机和防火墙等，本书（《计算机网络实验教程》）实验中网络设备均使用了IOS操作系统。IOS和主机上操作系统一样，是网络设备管理操作的灵魂，所有配置是通过 IOS完成的。因为使用方便高效,随后网络设备的操作系统基本采用了该种操作模式,通用性很强。IOS采用命令行界面(Command Line Interface, CLD。因为网络设备没有专门的屏幕和键盘，必须借助于虛拟终端实施操作，一般有两种途径：一是使用超级终端。通过串口线连接路由器的 CONSOLE 口，进行本地访问；二是Telnet远程终端，可以通过网络访问,但首次必须使用超级终端配置好网络地址,才能进行远程访问。IOS 操作系统分设置模式和操作模式两种运行模式。

### 接线原理

![](.\assets\4-1.PNG)

将计算机与交换机连接（计算机：RS232；交换机：RJ45）；

再将交换机与路由器相连（双绞线）

### 路由器的操作模式

1. 用户模式
网络设备启动后，如果已经进行了初始化设置，就自动进人用户模式，用户模式操作提示符采用符号“>”。以路由器为例，如router>，提示符前是路由器名(hostname），路由器名可以通过 hostname命令设置，具体名宇不作规定。用户模式下，操作以查询为主，一般不能对参数进行修改和设定，也查询不到主要参数。使用**enable 命令**，可以从用户模式切换到特权模式。退出用户模式，使用**logout 命令**，
2. 特权模式
    特权模式允许对配置进行修改和重要参数查看，特权模式使用受到口令保护，只有通过口令验证才能从用户模式切换到特权模式，特权模式操作提示符采用**符号“#”**。使用 **disable 命令**，可以从特权模式返回到用户模式；参数修改，则需要使用 **configure terminal 命令**，切换到配置模式。
3. 配置模式
    有时也称全局配置模式，全局配置模式操作提示符采用字符串提示符(config)。使用**exit命令**，可以从配置模式退回到特权模式；对于物理网络端口配置，还必须使用 interface 命令，切换到端口配置模式。
4. 端口配置模式
    端口配置模式主要对物理网络端口进行配置，常见对以太网端口和串行端口进行配置，端口配置模式采用**字符串提示符(config-if)**，端口配置完成后，使用 exit 命令，退回到配置模式，注意一定要退回到特权模式，配置参数才能生效。

| Command Mode                    | Access Method | Password      | Prompt Displayed | Exit Method |
| ------------------------------- | ------------- | ------------- | ---------------- | ----------- |
| User Exec用户                   | Log in        | Virtual       | >                | Logout      |
| Privileges Exec特权             | enable        | Enable Secret | #                | disable     |
| Global Configuration配置        | Config t      |               | (config)#        | Exit/ctrl+z |
| Interface Configuration端口配置 | Inter         |               | (config-if)#     | Exit/ctrl+z |

## 实验材料

1. 计算机，运行Windows操作系统
2. 超级终端 HyperTerminal
3. RS232转RJ45连接线、网线

## 实验内容

接线，测试不同的IOS操作模式，了解不同命令的区别和用法。

## 实验步骤

建立HyperTerminal：超级终端：名称=router；连接=com1；Baud Rate=9600；8，no parity，1 stop bit；呼叫

测试以下命令：

1. **?**
   操作帮助：代替符合命令格式的任何余项
   --寻求帮助：router01> ?
   --寻求帮助：router01> sh ?
2.  **show**
   --寻求帮助：router01> sh ?
   --查看系统配置：router01> sh version
   --查看（静态）路由表：router01>sh ip route
   --寻求帮助：router01> sh ?
   --寻求帮助：router01> sh in ?
   --寻求帮助：router01> sh int g ?
   --查看以太网口配置：router01> sh int gt 0/0
   --寻求帮助：router01> sh int ser ?
   --查看串口配置：router01> sh int serial 0/0
   --查看路由表配置信息：router01> sh running-config  #权限不够
3. **enable**
   --进入特权模式：router01>en(able) ，Enable Secret Password=**cisco**
   --查看路由表配置信息：router01# sh running-config 
   --寻求帮助：router01# sh int g ?
   --查看以太网口配置：router01# sh in g 0/0
   --寻求帮助：router01# sh int ser ?
   --查看串口配置：router01# sh int serial 0/0
4. **config**
   --进入配置模式：router01#config t
   --寻求帮助：router01(config)# ?
5. **interface**
   --寻求帮助：router01# inter fast ?
   --进入以太口：router01(config)#int g 0/0
   --修改IP地址： router01(config-if)#ip address 192.168.x.2
6. **end**
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int g 0/0
7. **ping** 
   --连通测试命令: router01# ping 192.168.x.254
8. **shut**
      关闭端口
   --进入配置模式：router01#config t
   --进入以太口：router01(config)#int g 0/0
   --关闭端口功能：router01(config-if)#no shut
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int g 0/0
9. **no**
   反命令
   --进入配置模式：router01#config t
   --进入以太口：router01(config)#int g 0/0
   --打开端口功能：router01(config-if)#no shut
   --退到特权模式：router01(config-if)#end(ctrl+z), exit
   --查看以太网口配置：router01# sh int gt 0/0
   --进入以太口：router01(config)#int g 0/0
   --删除IP地址： router01(config-if)#no ip address <ipaddress><subnet mask>

## 实验小结

本次实验初识路由器、交换机这一类耳熟能详但队其运作原理又非常陌生的设备。

对于路由器和交换机，我在网上了解到相关的资料如下：

路由器就是连接两个以上个别网络的设备。

由于位于两个或更多个网络的交汇处，从而可在它们之间传递分组（一种数据的组织形式）。路由器与交换机在概念上有一定重叠但也有不同：交换机泛指工作于任何网络层次的数据中继设备（尽管多指网桥），而路由器则更专注于网络层。

路由器与交换机的差别，路由器是属于OSI第三层的产品，交換机是OSI第二层的产品。第二层的产品功能在于，将网络上各个电脑的MAC地址记在MAC地址表中，当局域网中的电脑要经过交換机去交换传递资料时，就查询交换机上的MAC地址表中的信息，将数据包发送给指定的电脑，而不会像第一层的产品（如集线器）每台在网络中的电脑都发送。而路由器除了有交换机的功能外，更拥有路由表作为发送数据包时的依据，在有多种选择的路径中选择最佳的路径。此外，并可以连接两个以上不同网段的网络，而交换机只能连接两个。

了解IOS的操作，对于之后的实验应该也是一个基础。



# 实验5 - Socket编程实验

## 子实验1 - UDP协议网络编程实验

#### 实验目的

- 理解客户机/服务器模型，了解端口在网络传输中的作用
- 了解无连接通信方式以及编程方式
- 了解掌握基于Socket的UDP应用编程的基本步骤
- 了解并发服务原理及编程方式

#### 实验原理

##### Socket 概况

Socket套接字是基于TCP/IP传输层的网络编程标准。套接字已实现了TCP/IP协议的各种基础功能，并提供了高层的编程接口。使用者只用调用高层接口，就能实现相应功能。

##### UDP编程原理

UDP 是**User Datagram Protocol**的简称， 中文名是用户数据报协议，是OSI（**Open System Interconnection**，开放式系统互联） 参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务。

- `DatagramPacket`类，代表UDP数据对象。
- `DatagramSocket`类，代表UDP协议对象，对象包含了代表UDP端口的属性，两个主要方法：`send(DatagramPacket)`和`receiver(DatagramPacket)`。采用无连接的传输服务，直接通对方进行数据发送和接收。

#### 实验代码

`UDPServer.java`

```java
		DatagramSocket server=new DatagramSocket(5555); //创建Socket
		request=new DatagramPacket(buffer, buffer.length); //创建Socket数据包缓冲区
//...
		while(true){
            //receive message
			server.receive(request);
			String req=new String(request.getData()).trim();
            System.out.println("Request:"+req);
			//send message
			server.send(request);
		}
```

`UDPClient.java`

```java
	String serverIP = "";
		try {
            //获取UDP服务器地址对象
			serverIP = this.textFieldIP.getText();
			server = InetAddress.getByName(serverIP);
            
			System.out.println("Server:" + server.getHostAddress());
			
			byte[] bufferReceived = new byte[101];
			response = new DatagramPacket(bufferReceived, bufferReceived.length);
			this.btnSend.setEnabled(true);

		}

//...

	client = new DatagramSocket(); //创建Socket，但无需指定端口号。

//...

	//创建UDP数据包缓冲区request，存放应用数据，需要制定服务器地址和端口号。
	bufferSended = this.textMessage.getText().getBytes();
	client = new DatagramSocket();// client
	request = new DatagramPacket(bufferSended, bufferSended.length, server, 5555);
	// send
	client.send(request);   
	this.textMessage.setText("");
	// receive
	client.receive(response);
	this.textChat.setText(this.textChat.getText() + "\r\n" + new String(response.getData()).trim());	

```

#### 实验内容

在Eclipse中开发上述`UDPServer`和`UDPClient`两个类。

先运行服务器，后运行客户机，进行即时通信。

#### 实验结果

![](.\assets\5-1.png)

## 子实验2 - TCP协议与并发编程

#### 实验目的

- 理解客户机/服务器模型，了解端口在网络传输中的作用
- 了解无连接通信方式以及编程方式
- 了解基于TCP网络应用服务器的基本编程架构
- 了解面向连接和无连接的区别，了解TCP编程基本步骤
- 了解并发服务原理及编程方式

#### 实验原理

传输控制协议（TCP，**Transmission Control Protocol**）是一种面向连接的、可靠的、基于字节流的传输层通信协议。

##### 并发服务

UDP 采用无连接服务，可同时接待多个客户访问。TCP 采用面向连接方式，服务器一旦同一个客户机建立了会话，就无法同其他客户再建立会话，严重影响用户体验。并发服务能力是指服务器具有同时建立多个会话，允许多个客户访问的能力，日常使用的TCP 服务器均是并发服务器。但并发服务不属于网络技术而属于编程技术研究范畴，并发服务器程序有着特殊的编程架构，典型架构由两部分代码组成，第一部分是主进程，负责请求调度，按受客户请求申请,建立会话并为每个请求创建服务处理线程；第二部分是服务处理线程，负责具体会话处理，为客户请求提供服务，可以被主进程不断创建。

假定有两个客户访问同一个TCP 服务器。TCP 服务器启动后，只有主进程在运行，开启服务端口 PORT,等待客户端访问。第一个客户访问 PORT端口，主进程接收到请求 1，**创建一个服务线程** 1负责处理请求 1，随后的会话发生在客户机 1和服务线程 1之间，主进程等待下一次请求到来；第二个客户访问 PORT 端口，主进程接收到请求 2，再创建另一个服务线程 2负责处理请求，随后的会话发生在客户机 2和服务线程 2之间，主进程继续等待下一个请求。如果同时有 N个客户访问服务器，这时候，就有N+1个线程（进程）在运行；主进程永远
等待客户访问。并发处理的数量理论上没限制，主要取决于计算机处理能力，涉及 CPU 核数量和内存大小。

##### TCP实验程序编程

综上所述，除了需要客户机和服务器之外，还需要让服务器具备并发能力。所以需要创建三个类：客户机、服务器的主进程和服务器的服务线程。基本功能同UDP编程实验类似。

#### 实验代码

`MainServer.java`

```java
ServerSocket server = new ServerSocket(5588); //创建TCP服务Socket，Java提供ServerSocket专门作为TCP服务Socket

//...等待来自客户机的请求

	while (true) {
        //一旦成功就会创建Socket会话对象
		Socket client = server.accept();
        //接着创建ServiceServer服务进程，将Socket会话对象传递过去。
		ServiceServer service = new ServiceServer(client);
        //启动线程运行，负责同客户机的数据传输及处理。
		Thread thread=new Thread(service);
		thread.start();
		threadList.add(service);			
	}

```

`ServiceServer.java`作为服务线程负责实际数据处理和服务。

```java
//从会话对象Socket获得数据流，发送是输出流，接收为输入流。
public ServiceServer(Socket c)throws IOException{
		this.client=c;
		is=new ObjectInputStream(client.getInputStream());
		os=new ObjectOutputStream(client.getOutputStream());
	}
//利用输入输出流同客户端进行数据交互
Object obj=is.readObject();

BufferedReader in = new BufferedReader(new InputStreamReader(client.getInputStream()));
out = new PrintWriter(client.getOutputStream());//PrintWriter打印接收到的客户端数据

//交互结束，关闭会话对象
in.close();
out.close();
client.close();
```

`TcpClient.java`

```java
//请求同TCP服务器建立会话，指定服务器的地址和端口。
serviceSocket = new Socket(this.txtFieldIP.getText(), 5588);
//从会话对象Socket获得数据流。接收到消息就PrintWriter，反之写输入流。
out = new PrintWriter(serviceSocket.getOutputStream());
in = new BufferedReader(new InputStreamReader(serviceSocket.getInputStream()));
//交互结束，关闭会话对象。
serviceSocket.close();
```

#### 实验内容

开发服务器程序，创建实现`MainServer`类和`ServiceServer`类，再开发客户机程序`TcpClient`类，最后测试交互。可以在`main()`中双剑两个测试客户访问。

#### 实验结果

运行`MainServer`：

![](.\assets\5-2.png)

运行客户机并测试

![](.\assets\5-3.jpg)

## 实验小结 - Socket网络实验

TCP是面向连接的协议，在收发数据前必须和对方建立可靠的连接，建立连接的3次握手、断开连接的4次挥手，为数据传输打下可靠基础;UDP是一个面向无连接的协议，数据传输前，源端和终端不建立连接，发送端尽可能快的将数据扔到网络上，接收端从消息队列中读取消息段。

从上面TCP、UDP编程步骤可以看出，UDP 服务器端不需要调用监听(listen)和接收(accept)客户端连接，而客户端也不需要连接服务器端(connect)。UDP协议中，任何一方建立Socket后，都可以发送数据、接收数据，不必关心对方是否存在，是否发送了数据。

为了实现TCP网络通信的可靠性，增加校验和、序号标识、滑动窗口、确认应答、拥塞控制等复杂的机制，建立了繁琐的握手过程，增加了TCP对系统资源的消耗；TCP的重传机制、顺序控制机制等对数据传输有一定延时影响，降低了传输效率。TCP适合对传输效率要求低，但准确率要求高的应用场景，比如万维网(HTTP)、文件传输(FTP)、电子邮件(SMTP)等。

UDP是无连接的，不可靠传输，尽最大努力交付数据，协议简单、资源要求少、传输速度快、实时性高的特点，适用于对传输效率要求高，但准确率要求低的应用场景，比如域名转换(DNS)、远程文件服务器(NFS)等。

本次实验可以很好地展示两种协议的建立方法的不同，为今后的网络编程学习打下基础。



# 实验6 - 异步串行（物理层）通信实验

## 实验目的

- 理解异步串行通信基本原理
- 熟悉掌握RS-232通信标准以及RS-232帧格式
- 了解波特率等主要通信参数的作用和使用

## 实验原理

### 串行传输模式

串行传输模式是指任何通信用户单独只能占用一条通信信道，对二进制数据按照顺序依次发送，每次只能传输一个数位，0或1。串行传输模式被广泛应用在远程通信中。串行传输模式在实际运用中，又分为同步串行传输模式和异步串行传输模式。同步串行传输模式要求通信的收发双方在时间基准上保持一致。异步串行传输模式，接发两端使用不固定的时间模式，传输前也不需要协调，只要直接发送，不需要对方作为应答,但必须在传输两个数据包之间加人间隔符号作为分隔。常用的串行通信接口标准包括 RS-232，RS-449，V.24，V.35 等。其中，RS-232 是最常用的串行通信接口标准。

图为串行传输模式结构示意图。注意到并不是每一位都用来传输数据，还需要起始位、检验位相配合才能保证数据完整、准确运达。

![](.\assets\6-1.jpg)

### RS-232接口
RS-232 接口是 1970年由美国电子工业协会（EIA）联合贝尔实验室、调制解调器厂家及计算机终端生产厂家共同制定的用于异步串行传输模式的标准。主要内容就是定义数据终端设备 DTE 和数据通信设备 DCE之间的接口标准。RS-232 传输对象是宇符，每次传输一个宇
符，可持续传输多个字符。RS-232 异步串行传输模式，其物理信号采用电压作为传输信号，电压处于士15V之间，其信号状态标准：空闲状态信号，用负电压来表示；数位 0，用正电压来表示；数位1，用负电压表示。

### 波特率

波特率也称调制速率，指单位时间内通信信号变化的次数。波特率决定着每个数位的传输速率，显然，涉及接发两端的两个设备配置，为保证两者在发送信号和检测信号时的时间同步，就必须设置成相同的波特率。发送设备和接收设备采用相同波特率称为波特率匹配。如
果接发双方波特率不匹配，就会发生传输错误，称为帧错误。

### 循环冗余校验

循环冗余校验（英语：Cyclic redundancy check，通称“CRC”）是一种根据网络数据数据包或电脑文件等数据产生简短固定位数校验码的一种散列函數，主要用来检测或校验数据传输或者保存后可能出现的错误。生成的数字在传输或者存储之前计算出来并且附加到数据后面，然后接收方进行检验确定数据是否发生变化。

一般来说，循环冗余校验的值都是32位的整数。由于本函数易于用二进制的电脑硬件使用、容易进行数学分析并且尤其善于检测传输通道干扰引起的错误，因此获得广泛应用。此方是由W. Wesley Peterson于1961年发表。

CRC为校验和的一种，是两个字节数据流采用二进制除法（没有借位和进位，使用异或来代替减法）相除所得到的余数。其中被除数是需要计算校验和的信息数据流的二进制表示；除数是一个长度为(n+1)的预定义二进制数，通常用多项式的系数来表示。在做除法之前，要在信息数据之后先加上n个0. 冗余码的位数是n位。

冗余码的计算方法是，先将信息码后面补0，补0的个数是生成多项式最高次幂；将补零之后的信息码用模二除法（非二进制除法）除以G(X)对应的2进制码，注意除法过程中所用的减法是模2减法，即没有借位的减法，也就是异或运算。当被除数逐位除完时，得到比除数少一位的余数。此余数即为冗余位,将其添加在信息位后便构成CRC码字。

例如，假设信息码字为`11100011`，生成多项式`G(X)=X^5+X^4+X+1`，计算CRC码字。`G(X) = X^5+X^4+X+1`，也就是`110011`，因为最高次是5，所以，在信息码字后补5个0，变为`1110001100000`。用`1110001100000`模二除法除以`110011`，余数为`11010`，即为所求的冗余位。

因此发送出去的CRC码字为原始码字`11100011`末尾加上冗余位`11010`，即 `1110001111010`。接收端收到码字后，采用同样的方法验证，即将收到的码字用模二除法除以`110011`（是G(X)对应的二进制生成码），发现余数是0，则认为码字在传输过程中没有出错。

尽管在错误检测中非常有用，CRC并不能可靠地校验数据完整性（即数据没有发生任何变化），这是因为CRC多项式是线性结构，可以非常容易地故意改变量据而维持CRC不变。

### 奇偶校验位

奇偶校验位（英语：parity bit）或校验比特（英语：check bit）是一个表示给定位数的二进制数中1的个数是奇数还是偶数的二进制数。奇偶校验位是最简单的错误检测码。

奇偶校验位有两种类型：偶校验位与奇校验位。

以偶校验位来说，如果一组给定数据位中`1`的个数是奇数，补一个bit为`1`，使得总的1的个数是偶数。例：`0000001`, 补一个bit为`1`, `00000011`；以奇校验位来说，如果给定一组数据位中`1`的个数是奇数，补一个bit为`0`，使得总的`1`的个数是奇数。例：`0000001`， 补一个bit为`0`，即 `00000010`。

偶校验实际上是循环冗余校验的一个特例，通过多项式 `x + 1` 得到1位CRC。

### 并行传输与串行传输模式之区别

并行传输：字符编码的各位（比特）同时传输，也就是使用多根并行的数据线一次同时传输多个比特。

串行传输：将组成字符的各位串行依次地传输，使用一根数据线传输数据，一次传输1个比特，多个比特需要一个接一个依次传输；在串行传输中又分为同步传输和异步传输。

## 实验环境

实验环境由两台带串口的计算机组成，一根串行交叉线用于连接两个计算机的串口。使用“友善串口调试助手”作为串口调试软件。

## 实验内容

进行两台计算机之间的异步串行通信，一端从键盘输入字符发送，另一端观看接收到的内容。

1. 异步串行通信实验。相同通信参数下的通信，进行相互间的字符接发送。
2. 波特率通信实验。不同波特率条件下的通信，其他参数保持相同，进行相互间的字符接发送。
3. 不同校验方式通信实验。一方使用奇校验，一方不使用校验。
4. 相同校验方式实验。双方使用偶校验的通信情况。

## 实验步骤

首先，将两台计算机的COM口用串口反接连接线连接起来。

【实验一：异步串行通信实验】

1. 建立异步串行连接
2. 两台主机向对方发送消息。

观察到可以接收到完整的消息，且即时发送。

【实验二：波特率通信实验】

1. 重新设置通信参数，将波特率、校验位、数据位、停止位更改成不相同，再次实验。

观察到接收到的信息存在乱码，且乱码的出现**没有规律**，**不可逆**。

【实验三：不同校验方式通信实验】

1. 设置主机一方为偶校验，另一方为无校验。其他参数不变。

观察到对于采用了无校验位的一方，可以接收到另一方发来的有校验位的数据，但发送的数据并没有被另一方正确接收，显示为乱码。

这是因为接收端采用无校验位，不影响接受有校验位的数据；采用偶校验位，将对接收到的数据进行校验。

【实验四：相同校验方式通信实验】

1. 设置两台主机的校验方式相同，再进行上述实验。

观察到可以接收到完整且正确的数据。

## 实验小结

在物理层，数据的传输需要考虑的问题是：准确性、完整性和高效率。首先，采取相同的波特率可以让串口在同一频率上通信；其次，采取相同的奇偶校验位可以使传输的准确性大大增强。在串行通信中，常用的格式是7个数据位、1个校验位、1到2个停止位。这种格式用方便的8位字节巧妙地适应了所有的7位ASCII字符。也可以用其它的格式表示，8位数据加上1个校验位可以传输任意的8位字节数据。

## 实验图片

TODO:



# 实验7 - 主机路由实验

## 实验目的

TODO:

## 实验原理

## 实验材料

## 实验内容

## 实验步骤

## 实验小结

## 实验图片



# 实验8

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片



# 实验9

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片



# 实验10

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片



# 实验11

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片



# 实验12

## 实验目的

## 实验原理

## 实验环境

## 实验内容

## 实验步骤

## 实验小结

## 实验图片

